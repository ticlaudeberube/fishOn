
                (function($) {
            (function(){function k(a){throw a;}var l=void 0,p=!0,q=null,s=!1;function aa(){return function(){}}function t(a){return function(){return this[a]}}function ba(a){return function(){return a}}var v,w=this;function ca(a){a=a.split(".");for(var b=w,c;c=a.shift();)if(b[c]!=q)b=b[c];else return q;return b}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function x(a){return a!==l}function y(a){return"array"==da(a)}function A(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function B(a){return"string"==typeof a}function ea(a){return"boolean"==typeof a}function D(a){return"number"==typeof a}function fa(a){return"function"==da(a)}function E(a){var b=typeof a;return"object"==b&&a!=q||"function"==b}function ga(a){return a[ha]||(a[ha]=++ia)}
var ha="closure_uid_"+(1E9*Math.random()>>>0),ia=0;function ka(a,b,c){return a.call.apply(a.bind,arguments)}function ma(a,b,c){a||k(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function na(a,b,c){na=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ka:ma;return na.apply(q,arguments)}function oa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var pa=Date.now||function(){return+new Date};
function F(a,b){var c=a.split("."),d=w;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&x(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function G(a,b){function c(){}c.prototype=b.prototype;a.J=b.prototype;a.prototype=new c};function I(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;fa(Object.freeze)&&Object.freeze(this)}I.prototype.lower=l;I.prototype.upper=l;I.prototype.toJSON=function(){return qa(this)};function ra(a,b,c,d){return new I(a,b,c,d)}function sa(a){var b;y(a)?(b=ta(J(a)),b.push("\uffff")):B(a)?b=a+"\uffff":k(new K);return ra(a,b,s,p)}function qa(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}
function ua(a){return a==q?q:a instanceof va?va.bound(a.lower,a.upper,a.lowerOpen,a.upperOpen):a.upper!=q&&a.lower!=q?va.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):a.upper!=q?va.upperBound(a.upper,a.upperOpen):a.lower!=q?va.lowerBound(a.lower,a.lowerOpen):q}
function wa(a){if(a instanceof I)return"";if(a!=q){if(E(a)){for(var b in a)if(a.hasOwnProperty(b)&&!(0<=xa(["lower","upper","lowerOpen","upperOpen"],b)))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
I.prototype.lb=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;if(a.lower!=q&&(this.lower==q||a.lower>=this.lower))b=a.lower,d=a.lowerOpen||this.lowerOpen;if(a.upper!=q&&(this.upper==q||a.upper<=this.upper))c=a.upper,e=a.upperOpen||this.upperOpen;return ra(b,c,d,e)};
function ya(a,b,c,d,e){if(c)if(!c.lowerOpen&&!c.upperOpen&&c.lower!=q&&c.upper!=q&&0===za(c.lower,c.upper))d.push(a+" = ?"),e.push(Aa(c.lower,b));else{if(c.lower!=q){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(Aa(c.lower,b))}c.upper!=q&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(Aa(c.upper,b)))}}
function Ba(a,b,c,d){var e,f,g,h;if("^"==a)return sa(b);"<"==a||"<="==a?(e=b,g="<"==a):">"==a||">="==a?(f=b,h=">"==a):"="==a||"=="==a?e=f=b:k(new K("invalid op: "+a));"<"==c||"<="==c?(e=d,g="<"==c):">"==c||">="==c?(f=d,h=">"==c):x(c)&&k(new K("invalid op2: "+c));return ra(f,e,h,g)}var va=w.IDBKeyRange||w.webkitIDBKeyRange||I;function Ca(a,b){return 0==a.lastIndexOf(b,0)}function Da(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function Ea(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function Fa(a){if(!Ga.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ha,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ia,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ja,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(La,"&quot;"));return a}
var Ha=/&/g,Ia=/</g,Ja=/>/g,La=/\"/g,Ga=/[&<>\"]/;function Ma(a){return Ea(a.replace(/  /g," &#160;"),l)}function Na(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Oa={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Pa={"'":"\\'"};
function Qa(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,h;if(!(h=Oa[d])){if(!(31<e&&127>e))if(d in Pa)d=Pa[d];else if(d in Oa)d=Pa[d]=Oa[d];else{e=d;h=d.charCodeAt(0);if(31<h&&127>h)e=d;else{if(256>h){if(e="\\x",16>h||256<h)e+="0"}else e="\\u",4096>h&&(e+="0");e+=h.toString(16).toUpperCase()}d=Pa[d]=e}h=d}f[g]=h}b.push('"');return b.join("")};function Ra(a){Error.captureStackTrace?Error.captureStackTrace(this,Ra):this.stack=Error().stack||"";a&&(this.message=String(a))}G(Ra,Error);Ra.prototype.name="CustomError";function Sa(a,b){b.unshift(a);Ra.call(this,Da.apply(q,b));b.shift()}G(Sa,Ra);Sa.prototype.name="AssertionError";function Ta(a,b){k(new Sa("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};var Ua=Array.prototype,xa=Ua.indexOf?function(a,b,c){return Ua.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(B(a))return!B(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Xa=Ua.forEach?function(a,b,c){Ua.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ya=Ua.map?function(a,b,c){return Ua.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=B(a)?
a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Za=Ua.some?function(a,b,c){return Ua.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s};function $a(a,b){var c=ab(a,b,l);return 0>c?q:B(a)?a.charAt(c):a[c]}function ab(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}
function bb(a){if(!y(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function cb(a,b){var c=xa(a,b);0<=c&&Ua.splice.call(a,c,1)}function db(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function eb(a,b,c,d){Ua.splice.apply(a,gb(arguments,1))}function gb(a,b,c){return 2>=arguments.length?Ua.slice.call(a,b):Ua.slice.call(a,b,c)}
function hb(a,b){if(!A(a)||!A(b)||a.length!=b.length)return s;for(var c=a.length,d=ib,e=0;e<c;e++)if(!d(a[e],b[e]))return s;return p}function jb(a,b){return a>b?1:a<b?-1:0}function ib(a,b){return a===b};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function L(a,b){this.c=[];this.U=a;this.h=b||q}v=L.prototype;v.ea=s;v.Ca=s;v.mb=s;v.pc=s;v.Ab=s;v.nb=0;function kb(a,b){if(a.ea)a.b instanceof L&&kb(a.b);else{if(a.a){var c=a.a;delete a.a;b?kb(c,b):(c.nb--,0>=c.nb&&kb(c))}a.U?a.U.call(a.h,a):a.Ab=p;a.ea||a.m(new lb)}}v.Nb=function(a,b){this.mb=s;mb(this,a,b)};function mb(a,b,c){a.ea=p;a.b=c;a.Ca=!b;nb(a)}function ob(a){a.ea&&(a.Ab||k(new rb),a.Ab=s)}function M(a,b){ob(a);mb(a,p,b)}v.m=function(a){ob(this);mb(this,s,a)};
v.ca=function(a,b){return this.C(a,q,b)};v.Kb=function(a,b){return this.C(q,a,b)};v.nc=function(a,b){return this.C(a,a,b)};v.C=function(a,b,c){this.c.push([a,b,c]);this.ea&&nb(this);return this};function sb(a){return Za(a.c,function(a){return fa(a[1])})}
function nb(a){a.f&&(a.ea&&sb(a))&&(w.clearTimeout(a.f),delete a.f);a.a&&(a.a.nb--,delete a.a);for(var b=a.b,c=s,d=s;a.c.length&&!a.mb;){var e=a.c.shift(),f=e[0],g=e[1],e=e[2];if(f=a.Ca?g:f)try{var h=f.call(e||a.h,b);x(h)&&(a.Ca=a.Ca&&(h==b||h instanceof Error),a.b=b=h);b instanceof L&&(d=p,a.mb=p)}catch(j){b=j,a.Ca=p,sb(a)||(c=p)}}a.b=b;d&&(b.C(na(a.Nb,a,p),na(a.Nb,a,s)),b.pc=p);c&&(a.f=w.setTimeout(function(){k(b)},0))}function tb(a){var b=new L;M(b,a);return b}
function ub(a){Error.captureStackTrace?Error.captureStackTrace(this,ub):this.stack=Error().stack||"";a&&(this.message=String(a))}G(ub,Error);function rb(){ub.call(this)}G(rb,ub);rb.prototype.message="Deferred has already fired";rb.prototype.name="AlreadyCalledError";function lb(){ub.call(this)}G(lb,ub);lb.prototype.message="Deferred was cancelled";lb.prototype.name="CancelledError";function vb(){return new L}var wb={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},xb=w.webkitIDBRequest&&"LOADING"in w.webkitIDBRequest?w.webkitIDBTransaction||w.IDBTransaction:w.IDBRequest&&"LOADING"in w.IDBRequest?w.IDBTransaction:wb,N=xb.READ_ONLY,O=xb.READ_WRITE,yb=xb.VERSION_CHANGE;function zb(a,b){return a?b?"prevunique":"prev":b?"nextunique":"next"};function Ab(a,b){var c,d;2==arguments.length&&B(arguments[1])?(c=p,d=arguments[1].split(".")):d=(c=A(b))?b:arguments;for(c=c?0:1;c<d.length&&!(a=a[d[c]],!x(a));c++);return a}var Cb={};
function Db(a){a=[a];for(var b=new Eb,c=0,d,e;(e=a.pop())!==l;){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(Cb);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),Fb(b,e);else if(e instanceof Date)c+=2,b.write(c),Fb(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>2|255,
(f|3)<<6)}c.write(0)}else if(e===Cb)b.write(0);else return"";c=0}return b.trim().toString()}
function Fb(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Gb(a){var b=Hb(a)|0,c=b>>7?s:p,d=c?-1:1,e=(b&127)<<4,b=Hb(a)|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(Hb(a)|0):Hb(a)|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Ib(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=Hb(a);if(0===f||f==q)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Jb(a){this.a=q;this.b=a;this.c=this.b.length-1;this.index=-1}function Hb(a){return a.a=a.index<a.c?parseInt(a.b[++a.index]+a.b[++a.index],16):q}function Eb(){this.a=[];this.b=l}
Eb.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.b=arguments[b].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)};Eb.prototype.trim=function(){for(var a=this.a.length;"00"===this.a[--a];);this.a.length=++a;return this};Eb.prototype.toString=function(){return this.a.length?this.a.join(""):""};function Kb(a,b){var c=Db(a),d=Db(b);return c>d?1:c==d?0:-1};function K(a){Ra.call(this,a);this.name="ydn.error.ArgumentException"}G(K,Ra);function Lb(a){Ra.call(this,a);this.name="ydn.error.InvalidOperationException"}G(K,Ra);function Mb(a){Error.captureStackTrace?Error.captureStackTrace(this,Mb):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}G(Mb,Error);Mb.prototype.name="ydn.error.InternalError";function Nb(a,b,c,d,e){if(!(b instanceof I)){var f;B(b)?f=Ba(b,c,d,e):b!=q?b instanceof I?f=b:E(b)?f=new I(b.lower,b.upper,b.lowerOpen,b.upperOpen):k(new K("Invalid key range: "+b+" of type "+typeof b)):f=q;b=f}this.a=b;this.aa=a}Nb.prototype.aa="";Nb.prototype.lb=function(a){if(this.aa!=a.aa)return q;a=this.a!=q&&a.a!=q?this.a.lb(a.a):this.a||a.a;return new Nb(this.aa,a)};function Ob(a,b){for(var c in a)b.call(l,a[c],c,a)}function Pb(a,b){for(var c=A(b),d=c?b:arguments,c=c?0:1;c<d.length&&!(a=a[d[c]],!x(a));c++);return a}var Qb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Rb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Qb.length;f++)c=Qb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Sb,Tb,Ub,Vb;function Wb(){return w.navigator?w.navigator.userAgent:q}Vb=Ub=Tb=Sb=s;var Xb;if(Xb=Wb()){var Yb=w.navigator;Sb=0==Xb.indexOf("Opera");Tb=!Sb&&-1!=Xb.indexOf("MSIE");Ub=!Sb&&-1!=Xb.indexOf("WebKit");Vb=!Sb&&!Ub&&"Gecko"==Yb.product}var Zb=Sb,$b=Tb,ac=Vb,bc=Ub;function cc(){var a=w.document;return a?a.documentMode:l}var dc;
a:{var ec="",fc;if(Zb&&w.opera)var gc=w.opera.version,ec="function"==typeof gc?gc():gc;else if(ac?fc=/rv\:([^\);]+)(\)|;)/:$b?fc=/MSIE\s+([^\);]+)(\)|;)/:bc&&(fc=/WebKit\/(\S+)/),fc)var hc=fc.exec(Wb()),ec=hc?hc[1]:"";if($b){var ic=cc();if(ic>parseFloat(ec)){dc=String(ic);break a}}dc=ec}var jc={};
function kc(a){var b;if(!(b=jc[a])){b=0;for(var c=String(dc).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=/(\d*)(\D*)/g,n=/(\d*)(\D*)/g;do{var m=j.exec(g)||["","",""],r=n.exec(h)||["","",""];if(0==m[0].length&&0==r[0].length)break;b=((0==m[1].length?0:parseInt(m[1],10))<(0==r[1].length?0:parseInt(r[1],10))?-1:(0==m[1].length?0:parseInt(m[1],10))>(0==r[1].length?
0:parseInt(r[1],10))?1:0)||((0==m[2].length)<(0==r[2].length)?-1:(0==m[2].length)>(0==r[2].length)?1:0)||(m[2]<r[2]?-1:m[2]>r[2]?1:0)}while(0==b)}b=jc[a]=0<=b}return b}var lc=w.document,mc=!lc||!$b?l:cc()||("CSS1Compat"==lc.compatMode?parseInt(dc,10):5);function nc(a){return oc(a||arguments.callee.caller,[])}
function oc(a,b){var c=[];if(0<=xa(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(pc(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=pc(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(oc(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function pc(a){if(qc[a])return qc[a];a=String(a);if(!qc[a]){var b=/function ([^\(]+)/.exec(a);qc[a]=b?b[1]:"[Anonymous]"}return qc[a]}var qc={};function rc(a,b,c,d,e){"number"==typeof e||sc++;this.h=d||pa();this.f=a;this.e=b;this.c=c;delete this.b;delete this.a}rc.prototype.b=q;rc.prototype.a=q;var sc=0;function tc(a){this.f=a}tc.prototype.c=q;tc.prototype.b=q;tc.prototype.e=q;tc.prototype.a=q;function uc(a,b){this.name=a;this.value=b}uc.prototype.toString=t("name");var vc=new uc("SHOUT",1200),wc=new uc("SEVERE",1E3),xc=new uc("WARNING",900),yc=new uc("INFO",800),zc=new uc("CONFIG",700),Ac=new uc("FINE",500),Bc=new uc("FINER",400),Cc=new uc("FINEST",300),Dc=[new uc("OFF",Infinity),vc,wc,xc,yc,zc,Ac,Bc,Cc,new uc("ALL",0)],Ec=q;tc.prototype.getName=t("f");
function Fc(a){if(a.b)return a.b;if(a.c)return Fc(a.c);Ta("Root logger has no level set.");return q}tc.prototype.log=function(a,b,c){if(a.value>=Fc(this).value){a=this.h(a,b,c);b="log:"+a.e;w.console&&(w.console.timeStamp?w.console.timeStamp(b):w.console.markTimeline&&w.console.markTimeline(b));w.msWriteProfilerMark&&w.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=l;f=c.a[e];e++)f(d);b=b.c}}};
tc.prototype.h=function(a,b,c){var d=new rc(a,String(b),this.f);if(c){d.b=c;var e;var f=arguments.callee.caller;try{var g;var h=ca("window.location.href");if(B(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:h,stack:"Not available"};else{var j,n,m=s;try{j=c.lineNumber||c.Rc||"Not available"}catch(r){j="Not available",m=p}try{n=c.fileName||c.filename||c.sourceURL||w.$googDebugFname||h}catch(u){n="Not available",m=p}g=m||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,
name:c.name,lineNumber:j,fileName:n,stack:c.stack||"Not available"}:c}e="Message: "+Fa(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+Fa(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+Fa(nc(f)+"-> ")}catch(z){e="Exception trying to expose exception! You win, we lose. "+z}d.a=e}return d};function Gc(a,b){a.log(wc,b,l)}function P(a,b){a.log(xc,b,l)}function Hc(a,b){a.log(Ac,b,l)}function Q(a,b){a.log(Bc,b,l)}
function S(a,b){a.log(Cc,b,l)}var Ic={},Jc=q;function Kc(){Jc||(Jc=new tc(""),Ic[""]=Jc,Jc.b=zc)}function Lc(){Kc();return Jc}function V(a){Kc();var b;if(!(b=Ic[a])){b=new tc(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=V(a.substr(0,c));c.e||(c.e={});c.e[d]=b;b.c=c;Ic[a]=b}return b};function W(a,b,c,d,e,f){B(a)||k(new K("store name must be a string"));this.R=a;this.index=b;this.c=B(this.index);this.Q=x(f)?f:!!B(this.index);ea(this.Q)||k(new K("key_only"));x(d)&&!ea(d)&&k(new K("reverse"));x(e)&&!ea(e)&&k(new K("unique"));a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.direction=a;(d=wa(c))&&k(new K("Invalid key range: "+d));this.L=ua(c);this.Ra=[];this.Qb=[];this.Rb=[];this.pb=[];this.ob=[];this.e=0;this.F=this.b=this.a=l;this.Fa=s}
function Mc(a,b,c){3<arguments.length&&k(new K("too many argument"));W.call(this,a,l,b,c,l,p)}G(Mc,W);function Nc(a,b,c,d,e){B(b)||k(new K("index name must be string"));W.call(this,a,b,c,d,e,p)}G(Nc,W);function Oc(a,b,c){3<arguments.length&&k(new K("too many argument"));W.call(this,a,l,b,c,l,s)}G(Oc,W);function Pc(a,b,c,d,e){B(b)||k(new K("index name must be string"));W.call(this,a,b,c,d,e,s)}G(Pc,W);function Qc(a){return x(a.F)?a.F===s?a.Fa?"working":"resting":"completed":"initial"}v=W.prototype;
v.ec=V("ydn.db.Iterator");v.Ec=t("R");v.Ba=t("index");v.F=l;v.Fa=s;v.r=t("a");v.Cc=function(){return this.c?this.b:this.a};v.Dc=function(){return this.L?this.L instanceof va?this.L:va.bound(this.L.lower,this.L.upper,this.L.lowerOpen,this.L.upperOpen):q};v.Q=p;v.Fc=t("Q");v.toJSON=function(){return{store:this.R,index:this.index,key_range:this.L?qa(this.L):q,direction:this.direction}};
v.toString=function(){var a=x(this.index)?":"+this.index:"";if(this.a!=q){var b="]",c="[",d=Qc(this);"working"==d?(c="{",b="}"):"resting"==d&&(c="(",b=")");a+=" "+c+this.a+(this.c?", "+this.b:"")+b}b=this.c?"Index":"";b+=this.Q?"Key":"Value";return b+"Iterator:"+this.R+a};v.key=t("a");v.yc=function(a,b){this.a=a;this.b=b};v.Bc=t("e");v.rc=t("F");v.stores=function(){return[this.R].concat(this.Za)};v.Za=[];v.oc=[];v.Gc=function(){return"prev"===this.direction||"prevunique"===this.direction};
v.dc=function(){return"nextunique"===this.direction||"prevunique"===this.direction};v.Ra=[];v.Qb=[];v.Rb=[];v.pb=[];v.ob=[];function Rc(a){a.a=y(a.a)?db(a.a):a.a;a.b=y(a.b)?db(a.b):a.b;a.Fa=s;a.F=s;S(a.ec,a+": exited")}
function Sc(a,b,c,d){if(0<a.Ra.length){var e,f,g=a.F===s;g?(e=a.a,f=a.b):a.e=0;a.Fa=p;var h=[],j=d.b(b,c,a.R,a.index,a.L,a.direction,a.Q);j.wa(e,f,g);j.v=function(b,c){x(b)?(a.F=s,a.a=b,a.b=c,n()&&m()):(a.F=p,a.Fa=s)};e=function(b,c,d){n();x(c)&&(a.pb[b]=c,a.ob[b]=d);n()&&m()};for(f=0;f<a.Ra.length;f++)g=d.b(b,c,a.Rb[f]||a.R,a.Ra[f],a.Qb[f],a.direction,p),g.wa(a.pb[f],a.ob[f]),h.push(g),g.v=oa(e,f);var n=function(){return!h.some(function(a){return a.T})},m=function(){for(var b=s,c=p,d=[],e=a.a,f=
0;f<h.length;f++){var g=h[f];if(g.X()){var n=za(a.a,g.r());d[f]=n;1===n?c=s:-1===n&&(c=s,b=p,1===za(g.r(),e)&&(e=g.r()))}else c=s}if(c){j.u(j.r(),j.Fb(),j.fb());for(f=0;f<h.length;f++)h[f].forward(p)}else if(b){e!=a.a&&j.Aa(e);for(f=0;f<h.length;f++)0==d[f]?h[f].D(e):-1==d[f]?h[f].D(e):h[f].X()?e!=h[f].r()&&h[f].D(e):h[f].D(e)}else{a.a!=e&&j.D(e);for(f=0;f<h.length;f++)(!h[f].X()||0!==za(h[f].r(),e))&&h[f].D(e)}};b=j}else{var r;(e=a.F===s)?(g=a.a,r=a.b):a.e=0;a.F=l;var u=d.b(b,c,a.R,a.index,a.L,a.direction,
a.Q);S(a.ec,a+" created "+u);u.v=function(b,c,d){x(b)?(a.a=b,a.b=c,a.e++,u.u(b,c,d)):(a.F=p,u.u(l,l,l))};u.wa(g,r,e);b=u}return b}v.Hc=function(){"working"==Qc(this)&&k(new Tc("working"));this.e=0;this.F=this.b=this.a=l};function Uc(a,b,c,d,e,f){L.call(this,e,f);this.Y=a;this.e=[];this.k=!!b;this.Ya=!!c;this.Wa=!!d;for(b=0;b<a.length;b++)a[b].C(na(this.q,this,b,p),na(this.q,this,b,s));0==a.length&&!this.k&&M(this,this.e)}G(Uc,L);Uc.prototype.fa=0;Uc.prototype.q=function(a,b,c){this.fa++;this.e[a]=[b,c];this.ea||(this.k&&b?M(this,[a,c]):this.Ya&&!b?this.m(c):this.fa==this.Y.length&&M(this,this.e));this.Wa&&!b&&(c=q);return c};Uc.prototype.m=function(a){Uc.J.m.call(this,a);Xa(this.Y,function(a){kb(a)})};function Vc(a){Error.captureStackTrace?Error.captureStackTrace(this,Vc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}G(Vc,Error);function Wc(a){Error.captureStackTrace?Error.captureStackTrace(this,Wc):this.stack=Error().stack||"";a&&(this.message=String(a))}G(Wc,Error);Wc.prototype.name="ydn.db.InternalError";
function Xc(a){Error.captureStackTrace?Error.captureStackTrace(this,Xc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}G(Xc,Error);function Yc(a){Error.captureStackTrace?Error.captureStackTrace(this,Yc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}G(Yc,Error);function Zc(a){Error.captureStackTrace?Error.captureStackTrace(this,Zc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}
G(Zc,Error);Zc.prototype.name="NotFoundError";function $c(a){Error.captureStackTrace?Error.captureStackTrace(this,$c):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="DataCloneError"}G($c,Error);function ad(a,b){Error.captureStackTrace?Error.captureStackTrace(this,ad):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}G(ad,Error);
function bd(a,b){Error.captureStackTrace?Error.captureStackTrace(this,bd):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}G(bd,Error);function cd(a){Error.captureStackTrace?Error.captureStackTrace(this,cd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}G(cd,Error);
function dd(a){Error.captureStackTrace?Error.captureStackTrace(this,dd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}G(dd,Error);function ed(a,b,c){var d;E(a)?(d=a.store,b=a.id,a.parent!=q&&(c=new ed(a.parent))):x(b)?d=a:(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new ed(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],x(b)||k(Error("Invalid key value: "+a)));this.a=d;this.id=b;this.b=c||q}v=ed.prototype;v.toJSON=function(){var a={store:this.a,id:this.id};this.b&&(a.parent=this.b.toJSON());return a};v.valueOf=function(){return(this.b?this.b.valueOf()+"^|":"")+this.a+"^:"+this.id};
v.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};v.Jc=t("a");v.sc=t("id");v.Ic=t("b");function fd(a,b,c){this.na=a;this.a=b;this.f=c}fd.prototype.d=V("ydn.db.crud.req.RequestExecutor");fd.prototype.na="";fd.prototype.f="";fd.prototype.toString=function(){return"RequestExecutor:"+this.f};function gd(a){Error.captureStackTrace?Error.captureStackTrace(this,gd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}G(gd,Error);function hd(a){Error.captureStackTrace?Error.captureStackTrace(this,hd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}G(gd,Error);hd.prototype.name="ydn.error.NotSupportedException";
function id(a){Error.captureStackTrace?Error.captureStackTrace(this,id):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}G(id,Error);function jd(a){Error.captureStackTrace?Error.captureStackTrace(this,jd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}G(jd,Error);jd.prototype.name="ydn.InternalError";
function kd(a){Error.captureStackTrace?Error.captureStackTrace(this,kd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstrainError"}G(kd,Error);function ld(a){Error.captureStackTrace?Error.captureStackTrace(this,ld):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}G(gd,Error);
function Tc(a){Error.captureStackTrace?Error.captureStackTrace(this,Tc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}G(Tc,Error);V("ydn");function ta(a){if(!B(a)||/^[\s\xa0]*$/.test(a))return{};try{return JSON.parse(a)}catch(b){k(b)}}function md(a){var b;try{b=J(a)}catch(c){b=""}return b?b.substr(0,70):""}function J(a){return JSON.stringify(a)};function nd(a,b,c){fd.call(this,a,b,c)}G(nd,fd);v=nd.prototype;v.d=V("ydn.db.crud.req.IndexedDb");v.Pa=function(a,b,c,d){function e(b){var n=a.objectStore(d[b]).count();n.onsuccess=function(a){g[b]=a.target.result;b++;b==d.length?(Q(f.d,"success "+h),c(g),c=q):e(b)};n.onerror=function(a){P(f.d,"error "+h);c(a,p);c=q}}var f=this,g=[],h="TxNo:"+b+" countStores: "+d;S(this.d,h);0==d.length?(c([]),c=q):e(0)};
v.jb=function(a,b,c,d,e,f){a=a.objectStore(d);var g="TxNo:"+b+" addObject: "+d+" "+f;S(this.d,g);var h=this,j;j=x(f)?a.add(e,f):a.add(e);j.onsuccess=function(a){S(h.d,"success "+g);c(a.target.result)};j.onerror=function(){S(h.d,"error "+g);c(j.error||Error(),p)}};
v.wb=function(a,b,c,d,e,f){a=a.objectStore(d);var g="TxNo:"+b+" putObject: "+d+" "+(x(f)?f:"");S(this.d,g);var h=this;b=x(f)?a.put(e,f):a.put(e);b.onsuccess=function(a){S(h.d,"success "+g);c(a.target.result)};b.onerror=function(a){"DataError"==a.name&&(a=J(e),a=new Vc(d+": "+a.substring(0,70)));S(h.d,"error "+g);c(a,p)}};
v.kb=function(a,b,c,d,e,f){function g(a){var b;b=f!=q?m.add(e[a],f[a]):m.add(e[a]);b.onsuccess=function(b){j++;h[a]=b.target.result;j==e.length?(S(n.d,"success "+r),c(h)):(b=a+10,b<e.length&&g(b))};b.onerror=function(b){j++;"DataError"==b.name?b=new Vc('put to "'+d+'": '+a+" of "+e.length):"DataCloneError"==b.name&&(b=new $c('put to "'+d+'": '+a+" of "+e.length));S(n.d,"error "+r);c(b,p)}}var h=[],j=0,n=this,m=a.objectStore(d),r="TxNo:"+b+" addObjects: "+d+" "+e.length+" objects";S(this.d,r);if(0<
e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
v.xb=function(a,b,c,d,e,f){function g(a){var b;b=f!=q?u.put(e[a],f[a]):u.put(e[a]);b.onsuccess=function(b){n++;j[a]=b.target.result;n==e.length?h():(b=a+10,b<e.length&&g(b))};b.onerror=function(c){n++;P(r.d,"request result "+c.name+' error when put to "'+d+'" for object "'+md(e[a])+'" at index '+a+" of "+e.length+" objects.");j[a]=b.error||c.target.result;m=p;n==e.length?h():(c=a+10,c<e.length&&g(c))}}function h(){m?(S(r.d,"error "+z),c(j,p)):(S(r.d,"success "+z),c(j))}var j=[],n=0,m=s,r=this,u=a.objectStore(d),
z="TxNo:"+b+" putObjects: "+d+" "+e.length+" objects";S(this.d,z);if(0<e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
v.Yb=function(a,b,c,d,e){function f(b){var c=e[b],r=c.a,C=a.objectStore(r),T;T=C.keyPath===q?C.put(d[b],c.id):C.put(d[b]);T.onsuccess=function(a){j++;h[b]=a.target.result;j==d.length?g():(a=b+10,a<d.length&&f(a))};T.onerror=function(a){j++;P(m.d,"request result "+a.name+' error when put keys to "'+r+'" for object "'+md(d[b])+'" at index '+b+" of "+d.length+" objects.");h[b]=T.error||a.target.result;n=p;j==d.length?g():(a=b+10,a<d.length&&f(a))}}function g(){n?(S(m.d,"error "+r),c(h,p)):(S(m.d,"success "+
r),c(h))}var h=[],j=0,n=s,m=this,r="TxNo:"+b+" putByKeys: of "+d.length+" objects";S(this.d,r);if(0<d.length)for(b=0;10>b&&b<d.length;b++)f(b);else g()};v.yb=function(a,b,c,d,e){var f=this;a=a.objectStore(d);var g="TxNo:"+b+" clearById: "+d+" "+e;S(this.d,g);b=a.openCursor(e);b.onsuccess=function(a){var b=a.target.result;b?(b=b["delete"](),b.onsuccess=function(){S(f.d,"success "+g);c(1)},b.onerror=function(){c(a,p)}):c(l)};b.onerror=function(a){S(f.d,"error "+g);c(a,p)}};
v.$b=function(a,b,c,d,e){var f=this,g=a.objectStore(d);a=g.count(e);var h="TxNo:"+b+" clearByKeyRange: "+d+" "+e;S(this.d,h);a.onsuccess=function(a){var b=a.target.result;a=g["delete"](e);a.onsuccess=function(){S(f.d,"success "+h);c(b)};a.onerror=function(a){S(f.d,"error "+h);c(a,p)}};a.onerror=function(a){S(f.d,"count error "+h);c(a,p)}};
v.Lb=function(a,b,c,d,e){var f=this;a=a.objectStore(d);var g="TxNo:"+b+" clearByKeyRange: "+d+" "+e;S(this.d,g);b=a["delete"](e);b.onsuccess=function(){S(f.d,"success "+g);c(l)};b.onerror=function(a){S(f.d,"error "+g);c(a,p)}};
v.Zb=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d).index(e);var h="TxNo:"+b+" clearByIndexKeyRange: "+d+":"+e+" "+f;S(this.d,h);b=a.openCursor(f);var j=0;b.onsuccess=function(a){var b=a.target.result;b?(a=b["delete"](),a.onsuccess=function(){j++;b["continue"]()},a.onerror=function(a){S(g.d,"error "+h);k(a)}):(S(g.d,"success "+h),c(j))};b.onerror=function(a){S(g.d,"error "+h);c(a,p)}};
v.Oa=function(a,b,c,d){var e=this,f=d.length,g=0,h="TxNo:"+b+" clearByStores: "+d;S(this.d,h);for(b=0;b<f;b++){var j=a.objectStore(d[b]).clear();j.onsuccess=function(){g++;g==f&&(S(e.d,"success "+h),c(g))};j.onerror=function(a){g++;g==f&&(S(e.d,"error "+h),c(a,p))}}};
function od(a,b,c,d,e,f,g,h,j,n,m){var r=[];b=b.objectStore(e);h=zb(h,m);var u="TxNo:"+c+" listByKeyRange: "+e+(f?":"+f:"")+(g?J(g):"");S(a.d,u);c=f?b.index(f).openCursor(g,h):b.openCursor(g,h);var z=s;c.onsuccess=function(b){if(b=b.target.result)if(!z&&0<n)z=p,b.advance(n);else if(r.push(b.value),r.length<j)b["continue"]();else S(a.d,"success "+u),d(r);else S(a.d,"success "+u),d(r)};c.onerror=function(b){S(a.d,"error "+u);d(b,p)}}v.Ha=function(a,b,c,d,e,f,g,h){od(this,a,b,c,d,q,e,f,g,h)};
v.Ga=function(a,b,c,d,e,f,g,h,j,n){od(this,a,b,c,d,e,f,g,h,j,n)};v.Ub=function(a,b,c,d,e,f,g,h){var j=[],n=this;a=a.objectStore(d);f=zb(f);var m="TX"+b+" keysByKeyRange: "+d+" "+e;S(this.d,m);b=a.openCursor(e,f);var r=s;b.onsuccess=function(a){if(a=a.target.result)if(!r&&0<h)r=p,a.advance(h);else if(j.push(a.key),j.length<g)a["continue"]();else S(n.d,"success "+m),c(j);else S(n.d,"success "+m),c(j)};b.onerror=function(a){S(n.d,"error "+m);c(a,p)}};
v.Tb=function(a,b,c,d,e,f,g,h,j,n){var m=[],r=this;a=a.objectStore(d).index(e);var u="TxNo:"+b+" keysByStore: "+d+":"+e+" "+f;S(this.d,u);b=a.openKeyCursor(f,zb(g,n));var z=s;b.onsuccess=function(a){if(a=a.target.result)if(!z&&0<j)z=p,a.advance(j);else{if(m.push(a.primaryKey),m.length<h)a["continue"]()}else S(r.d,"success "+u),c(m)};b.onerror=function(a){S(r.d,"error "+u);c(a,p)}};
v.Sa=function(a,b,c,d,e){var f=this,g="TxNo:"+b+" getById: "+d+":"+e;S(this.d,g);a=a.objectStore(d).get(e);a.onsuccess=function(a){S(f.d,"success "+g);c(a.target.result)};a.onerror=function(a){S(f.d,"error "+g);c(a,p)}};
v.sb=function(a,b,c,d,e){function f(a){if(e[a]==q)if(j++,h[a]=l,j==m)S(g.d,"success "+r),c(h);else{var b=a+10;b<m&&f(b)}var d;try{d=n.get(e[a])}catch(C){"DataError"==C.name&&k(new Vc(e[a])),k(C)}d.onsuccess=function(b){j++;h[a]=b.target.result;j==m?(S(g.d,"success "+r),c(h)):(b=a+10,b<m&&f(b))};d.onerror=function(a){j++;S(g.d,"error "+r);c(a,p)}}var g=this,h=[],j=0,n=a.objectStore(d),m=e.length,r="TxNo:"+b+" listByIds: "+d+":"+m+" ids";S(this.d,r);if(0<m)for(a=0;10>a&&a<m;a++)f(a);else c([])};
v.tb=function(a,b,c,d){function e(b){var m=d[b],m=a.objectStore(m.a).get(m.id);m.onsuccess=function(a){h++;g[b]=a.target.result;h==d.length?(S(f.d,"success "+j),c(g)):(a=b+10,a<d.length&&e(a))};m.onerror=function(a){h++;S(f.d,"error "+j);c(a,p)}}var f=this,g=[],h=0,j="TxNo:"+b+" listByKeys: "+d.length+" ids";S(this.d,j);if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b);else c([])};
v.ma=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d);var h="TxNo:"+b+" countKeyRange: "+d+(f?":"+f:"")+(e?":"+J(e):"");S(this.d,h);f!=q?(b=a.index(f),e=e!=q?b.count(e):b.count()):e=e!=q?a.count(e):a.count();e.onsuccess=function(a){S(g.d,"success "+h);c(a.target.result)};e.onerror=function(a){S(g.d,"error "+h);c(a,p)}};function pd(){0!=qd&&(rd[ga(this)]=this)}var qd=0,rd={};pd.prototype.Y=s;pd.prototype.s=function(){if(!this.Y&&(this.Y=p,this.oa(),0!=qd)){var a=ga(this);delete rd[a]}};pd.prototype.oa=function(){if(this.fa)for(;this.fa.length;)this.fa.shift()()};var sd=!$b||$b&&9<=mc,td=$b&&!kc("9");!bc||kc("528");ac&&kc("1.9b")||$b&&kc("8")||Zb&&kc("9.5")||bc&&kc("528");ac&&!kc("8")||$b&&kc("9");function ud(a,b){this.type=a;this.a=this.target=b}ud.prototype.s=aa();ud.prototype.b=s;ud.prototype.c=p;ud.prototype.qb=function(){this.c=s};function vd(a){vd[" "](a);return a}vd[" "]=aa();function wd(a,b){a&&xd(this,a,b)}G(wd,ud);v=wd.prototype;v.target=q;v.clientX=0;v.clientY=0;v.Pb=q;function xd(a,b,c){var d=a.type=b.type;ud.call(a,d);a.target=b.target||b.srcElement;a.a=c;if((c=b.relatedTarget)&&ac)try{vd(c.nodeName)}catch(e){}a.clientX=b.clientX!==l?b.clientX:b.pageX;a.clientY=b.clientY!==l?b.clientY:b.pageY;a.Pb=b;b.defaultPrevented&&a.qb();delete a.b}
v.qb=function(){wd.J.qb.call(this);var a=this.Pb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,td)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var yd=0;function zd(){}zd.prototype.key=0;zd.prototype.ja=s;zd.prototype.Na=s;zd.prototype.handleEvent=function(a){return this.a?this.ga.call(this.rb||this.src,a):this.ga.handleEvent.call(this.ga,a)};var Ad={},Bd={},Cd={},Dd={};
function Ed(a,b,c,d,e){if(y(b))for(var f=0;f<b.length;f++)Ed(a,b[f],c,d,e);else{a:{b||k(Error("Invalid event type"));d=!!d;var g=Bd;b in g||(g[b]={M:0,z:0});g=g[b];d in g||(g[d]={M:0,z:0},g.M++);var g=g[d],f=ga(a),h;g.z++;if(g[f]){h=g[f];for(var j=0;j<h.length;j++)if(g=h[j],g.ga==c&&g.rb==e){if(g.ja)break;h[j].Na=s;a=h[j];break a}}else h=g[f]=[],g.M++;var n=Fd,m=sd?function(a){return n.call(m.src,m.ga,a)}:function(a){a=n.call(m.src,m.ga,a);if(!a)return a},j=m,r=g=new zd;fa(c)?r.a=p:c&&c.handleEvent&&
fa(c.handleEvent)?r.a=s:k(Error("Invalid listener argument"));r.ga=c;r.b=j;r.src=a;r.type=b;r.capture=!!d;r.rb=e;r.Na=s;r.key=++yd;r.ja=s;g.Na=s;j.src=a;j.ga=g;h.push(g);Cd[f]||(Cd[f]=[]);Cd[f].push(g);a.addEventListener?(a==w||!a.Ob)&&a.addEventListener(b,j,d):a.attachEvent(b in Dd?Dd[b]:Dd[b]="on"+b,j);a=g}Ad[a.key]=a}}
function Gd(a,b,c,d,e){if(y(b))for(var f=0;f<b.length;f++)Gd(a,b[f],c,d,e);else{d=!!d;a:{f=Bd;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ga(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].ga==c&&a[f].capture==d&&a[f].rb==e){Hd(a[f].key);break}}}
function Hd(a){var b=Ad[a];if(b&&!b.ja){var c=b.src,d=b.type,e=b.b,f=b.capture;c.removeEventListener?(c==w||!c.Ob)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Dd?Dd[d]:Dd[d]="on"+d,e);c=ga(c);Cd[c]&&(e=Cd[c],cb(e,b),0==e.length&&delete Cd[c]);b.ja=p;if(b=Bd[d][f][c])b.Wb=p,Id(d,f,c,b);delete Ad[a]}}
function Id(a,b,c,d){if(!d.Xa&&d.Wb){for(var e=0,f=0;e<d.length;e++)d[e].ja?d[e].b.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Wb=s;0==f&&(delete Bd[a][b][c],Bd[a][b].M--,0==Bd[a][b].M&&(delete Bd[a][b],Bd[a].M--),0==Bd[a].M&&delete Bd[a])}}function Jd(a,b,c,d,e){var f=1;b=ga(b);if(a[b]){var g=--a.z,h=a[b];h.Xa?h.Xa++:h.Xa=1;try{for(var j=h.length,n=0;n<j;n++){var m=h[n];m&&!m.ja&&(f&=Kd(m,e)!==s)}}finally{a.z=Math.max(g,a.z),h.Xa--,Id(c,d,b,h)}}return Boolean(f)}
function Kd(a,b){a.Na&&Hd(a.key);return a.handleEvent(b)}
function Fd(a,b){if(a.ja)return p;var c=a.type,d=Bd;if(!(c in d))return p;var d=d[c],e,f;if(!sd){e=b||ca("window.event");var g=p in d,h=s in d;if(g){if(0>e.keyCode||e.returnValue!=l)return p;a:{var j=s;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(n){j=p}if(j||e.returnValue==l)e.returnValue=p}}j=new wd;xd(j,e,this);e=p;try{if(g){for(var m=[],r=j.a;r;r=r.parentNode)m.push(r);f=d[p];f.z=f.M;for(var u=m.length-1;!j.b&&0<=u&&f.z;u--)j.a=m[u],e&=Jd(f,m[u],c,p,j);if(h){f=d[s];f.z=f.M;for(u=0;!j.b&&u<m.length&&
f.z;u++)j.a=m[u],e&=Jd(f,m[u],c,s,j)}}else e=Kd(a,j)}finally{m&&(m.length=0)}return e}c=new wd(b,this);return e=Kd(a,c)};function Ld(){pd.call(this)}G(Ld,pd);v=Ld.prototype;v.Ob=p;v.vb=q;v.addEventListener=function(a,b,c,d){Ed(this,a,b,c,d)};v.removeEventListener=function(a,b,c,d){Gd(this,a,b,c,d)};
function Md(a,b){var c=b,d=c.type||c,e=Bd;if(d in e){if(B(c))c=new ud(c,a);else if(c instanceof ud)c.target=c.target||a;else{var f=c,c=new ud(d,a);Rb(c,f)}var f=1,g,e=e[d],d=p in e,h;if(d){g=[];for(h=a;h;h=h.vb)g.push(h);h=e[p];h.z=h.M;for(var j=g.length-1;!c.b&&0<=j&&h.z;j--)c.a=g[j],f&=Jd(h,g[j],c.type,p,c)&&c.c!=s}if(s in e)if(h=e[s],h.z=h.M,d)for(j=0;!c.b&&j<g.length&&h.z;j++)c.a=g[j],f&=Jd(h,g[j],c.type,s,c)&&c.c!=s;else for(e=a;!c.b&&e&&h.z;e=e.vb)c.a=e,f&=Jd(h,e,c.type,s,c)&&c.c!=s}}
v.oa=function(){Ld.J.oa.call(this);var a=0;if(this!=q){var b=ga(this);if(Cd[b])for(var b=Cd[b],c=b.length-1;0<=c;c--)Hd(b[c].key),a++}else Ob(Ad,function(b,c){Hd(c);a++});this.vb=q};function Nd(a,b,c){fa(a)?c&&(a=na(a,c)):a&&"function"==typeof a.handleEvent?a=na(a.handleEvent,a):k(Error("Invalid listener argument"));2147483647<b||w.setTimeout(a,b||0)};function Od(a,b,c){fd.call(this,a,b,c)}G(Od,fd);v=Od.prototype;v.jb=function(a,b,c,d,e,f){a=Pd(a,e,d,f);c(a)};v.wb=function(a,b,c,d,e,f){a=Pd(a,e,d,f);c(a)};v.kb=function(a,b,c,d,e,f){b=[];for(var g=0;g<e.length;g++)b[g]=Pd(a,e[g],d,x(f)?f[g]:l);c(b)};v.xb=function(a,b,c,d,e,f){b=[];for(var g=0;g<e.length;g++)b[g]=Pd(a,e[g],d,x(f)?f[g]:l);c(b)};v.Sa=function(a,b,c,d,e){c(Qd(a,d,e))};v.sb=function(a,b,c,d,e){b=[];for(var f=0;f<e.length;f++){var g=Qd(a,d,e[f]);b.push(g)}c(b)};v.Ha=aa();
v.tb=function(a,b,c,d){b=[];for(var e=0;e<d.length;e++){var f=Qd(a,d[e].a,d[e].id);b.push(f)}c(b)};v.Ga=aa();v.yb=function(a,b,c,d,e){Rd(a,d,e);c(p)};v.Oa=function(a,b,c,d){for(b=0;b<d.length;b++)Rd(a,d[b]);c(p)};v.Pa=function(a,b,c,d){Nd(function(){for(var b=[],f=0;f<d.length;f++){var g=a.Ta(d[f]);b[f]=g.length}c(b)},0,this)};v.ma=function(a,b,c,d){b="_database_"+this.na;x(d)&&(b+="-"+d);d=0;for(var e in a)a.hasOwnProperty(e)&&Ca(e,b)&&d++;c(d)};F("ydn.async.all",function(a){for(var b=[],c,d=0;c=a[d];d++){var e=new L;c.success(oa(function(a,b){M(a,b)},e));c.error(oa(function(a,b){a.m(b)},e));b[d]=e}return new Uc(b)});function Sd(a,b,c){fd.call(this,a,b,c)}G(Sd,fd);v=Sd.prototype;v.d=V("ydn.db.crud.req.WebSql");function Td(a,b){var c=a._default_?ta(a._default_):{};if(b.keyPath!=q){var d=Ud(a[b.keyPath],b.type);d!=q&&Xd(b,c,d)}for(d=0;d<b.indexes.length;d++){var e=b.indexes[d],f=e.b;"_default_"==f||(e.c||e.multiEntry)||(f=Ud(a[f],e.type),x(f)&&(c[e.name]=f))}return c}v.Ub=function(a,b,c,d,e,f,g,h){Yd(this,a,b,c,p,d,l,e,f,g,h,s)};v.Tb=function(a,b,c,d,e,f,g,h,j,n){Yd(this,a,b,c,p,d,e,f,g,h,j,n)};
function Yd(a,b,c,d,e,f,g,h,j,n,m,r){var u=[],z=X(a.a,f),H=z.c;g!=q&&g!==H&&Zd(z,g);f=[];g=$d(z,f,e?ae:be,g||H,h,j,r);D(n)&&(g+=" LIMIT "+n);D(m)&&(g+=" OFFSET "+m);var C="TX"+c+" SQL: "+g+" PARAMS: "+J(f);S(a.d,C);b.executeSql(g,f,function(b,c){for(var f=c.rows.length,g=0;g<f;g++){var h=c.rows.item(g);e?u[g]=Ud(h[H],z.type):h!=q&&(u[g]=Td(h,z))}Q(a.d,"success "+C);d(u)},function(b,c){P(a.d,"error: "+C+c.message);d(c,p);return s})}v.jb=function(a,b,c,d,e,f){ce(this,a,b,c,p,p,d,[e],[f])};
v.wb=function(a,b,c,d,e,f){ce(this,a,b,c,s,p,d,[e],[f])};v.kb=function(a,b,c,d,e,f){ce(this,a,b,c,p,s,d,e,f)};
function ce(a,b,c,d,e,f,g,h,j){function n(b,g){h[b]==q&&k(new Lb("inserting "+(x(h[b])?"null":"undefined")+"object "+(1==h.length?"":" at "+b+" of "+h.length)+' "'+md(h[b])));var R;R=x(j)?de(m,h[b],j[b]):de(m,h[b]);var U=r+ee(m)+" ("+R.Mb.join(", ")+") VALUES ("+R.bc.join(", ")+");",ja="TX"+c+" SQL: "+U+" PARAMS: "+R.B+" REQ: "+b+" of "+h.length;S(a.d,ja);g.executeSql(U,R.B,function(e,j){function ja(b,d){var e=r+Qa("ydn.db.me:"+m.getName()+":"+b.getName())+" ("+m.a+", "+b.a+") VALUES (?, ?)",f=[Aa(U,
m.type),d];S(a.d,"TX"+c+" multiEntry "+e+" "+f);g.executeSql(e,f,aa(),function(b,c){P(a.d,"multiEntry index insert error: "+c.message);return s})}z++;for(var U=x(R.key)?R.key:j.insertId,la=0,qb=m.indexes.length;la<qb;la++){var Wa=m.index(la);if(Wa.multiEntry)for(var Bb=Ab(h[b],Wa.keyPath),eg=(!Bb?0:Bb.length)||0,Wd=0;Wd<eg;Wd++)ja(Wa,Bb[Wd])}f?(Q(a.d,"success "+H),d(U)):(u[b]=U,z==h.length?(Q(a.d,"success "+H),d(u)):(la=b+2,la<h.length&&n(la,e)))},function(c,g){z++;if(6==g.code&&e)if(f)Q(a.d,"success "+
ja),d(g,p);else if(u[b]=q,z==h.length)S(a.d,"success "+H),d(u);else{var j=b+2;j<h.length&&n(j,c)}else P(a.d,"error: "+g.message+" "+H),d(g,p);return s})}var m=X(a.a,g),r=e?"INSERT INTO ":"INSERT OR REPLACE INTO ",u=[],z=0,H="TX"+c+" inserting "+h.length+" objects.";if(0<h.length)for(g=0;2>g&&g<h.length;g++)n(g,b);else Q(a.d,"success"),d([])}v.xb=function(a,b,c,d,e,f){ce(this,a,b,c,s,s,d,e,f)};
v.Yb=function(a,b,c,d,e){if(0==e.length)c([]);else{for(var f=[],g=0,h=0,j=this,n=function(n,m){var r=[];S(j.d,"put "+m.length+" objects to "+n);for(var u,z=(u=!!X(j.a,n).keyPath)?l:[],C=0;C<m.length;C++)r.push(d[m[C]]),u||z.push(e[m[C]].id);ce(j,a,b,function(a,b){if(b)g++,g==h&&c(a,p);else{for(var d=0;d<m.length;d++)f[m[d]]=a[d];g++;g==h&&c(f)}},s,s,n,r,z)},m="",r=[],u=[],z=0;z<e.length;z++){var H=e[z].a,C=e[z].id;H!=m?(h++,0<r.length&&n(m,r),r=[z],u=[C],m=H):(r.push(z),u.push(C))}0<r.length&&n(m,
r)}};v.Sa=function(a,b,c,d,e){var f=X(this.a,d),g=this;d=f.a;e=[Aa(e,f.type)];d="SELECT * FROM "+ee(f)+" WHERE "+d+" = ?";var h="TxNo"+b+" SQL: "+d+" PARAMS: "+e;S(this.d,h);a.executeSql(d,e,function(a,b){if(0<b.rows.length){var d=b.rows.item(0);d!=q?(d=Td(d,f),c(d)):(Q(g.d,"success: "+h),c(l))}else Q(g.d,"success no result: "+h),c(l)},function(a,b){P(g.d,"error: "+h+" "+b.message);c(b,p);return s})};
v.sb=function(a,b,c,d,e){function f(a,d){var u=n.a,z=[Aa(e[a],n.type)],H="SELECT * FROM "+ee(n)+" WHERE "+u+" = ?";S(g.d,"SQL: "+H+" PARAMS: "+z);d.executeSql(H,z,function(d,r){j++;if(0<r.rows.length){var u=r.rows.item(0);u!=q&&(h[a]=Td(u,n))}else h[a]=l;j==e.length?(Q(g.d,"TxNo:"+b+"success "+H),c(h)):(u=a+10,u<e.length&&f(u,d))},function(d,n){j++;P(g.d,"error: "+H+" "+n.message);if(j==e.length)Q(g.d,"TxNo:"+b+"success "+H),c(h);else{var r=a+10;r<e.length&&f(r,d)}return s})}var g=this,h=[],j=0,n=
X(this.a,d);if(0<e.length)for(d=0;10>d&&d<e.length;d++)f(d,a);else Q(g.d,"success"),c([])};v.Ha=function(a,b,c,d,e,f,g,h){Yd(this,a,b,c,s,d,l,e,f,g,h,s)};v.Ga=function(a,b,c,d,e,f,g,h,j,n){Yd(this,a,b,c,s,d,e,f,g,h,j,n)};
v.tb=function(a,b,c,d){function e(a,b){var m=d[a],r=X(f.a,m.a),u=y(m.id)?m.id.join("^|"):m.id,m=r.a,u=[Aa(u,r.type)],z="SELECT * FROM "+ee(r)+" WHERE "+m+" = ?";S(f.d,"SQL: "+z+" PARAMS: "+u);b.executeSql(z,u,function(b,n){h++;if(0<n.rows.length){var m=n.rows.item(0);m!=q&&(g[a]=Td(m,r))}else g[a]=l;h==d.length?(S(f.d,"success "+z),c(g)):(m=a+10,m<d.length&&e(m,b))},function(a,b){P(f.d,"error: "+z+" "+b.message);c(b,p);return s})}var f=this,g=[],h=0;if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b,
a);else S(this.d,"success"),c([])};
v.Oa=function(a,b,c,d){function e(a,b){var j=X(f.a,d[a]),n="DELETE FROM  "+ee(j);S(f.d,"SQL: "+n+" PARAMS: []");b.executeSql(n,[],function(b){a==d.length-1?(S(f.d,"success "+n),c(d.length)):e(a+1,b)},function(a,b){P(f.d,"error: "+n+" "+b.message);c(b,p);return s});for(var m=0,r=j.indexes.length;m<r;m++){var u=j.index(m);u.multiEntry&&(u="DELETE FROM  "+Qa("ydn.db.me:"+j.getName()+":"+u.getName()),S(f.d,"SQL: "+u),b.executeSql(u,[]))}}var f=this;0<d.length?e(0,a):(S(this.d,"success"),c(0))};
v.yb=function(a,b,c,d,e){d=X(this.a,d);e=Aa(e,d.type);var f=this,g=" WHERE "+d.a+" = ?",h="DELETE FROM "+ee(d)+g,j="TX"+b+" SQL: "+h+" PARAMS: "+[e];S(this.d,j);a.executeSql(h,[e],function(a,b){S(f.d,"success "+j);c(b.rowsAffected)},function(a,b){P(f.d,"error: "+j+b.message);c(b,p);return s});for(var h=0,n=d.indexes.length;h<n;h++){var m=d.index(h);m.multiEntry&&(m="DELETE FROM  "+Qa("ydn.db.me:"+d.getName()+":"+m.getName())+g,S(f.d,"TX"+b+NaN+m),a.executeSql(m,[e]))}};
v.Lb=function(a,b,c,d,e){fe(this,a,b,c,d,l,e)};v.$b=function(a,b,c,d,e){fe(this,a,b,c,d,l,e)};v.Zb=function(a,b,c,d,e,f){fe(this,a,b,c,d,e,f)};
function fe(a,b,c,d,e,f,g){e=X(a.a,e);var h="DELETE FROM "+ee(e),j=[],n=[],m="";g!=q&&(x(f)?(m=Zd(e,f),ya(m.a,m.type,g,n,j)):ya(e.a,e.type,g,n,j),m=" WHERE "+n.join(" AND "));var h=h+m,r="TX"+c+" SQL: "+h+" PARAMS: "+j;S(a.d,r);b.executeSql(h,j,function(b,c){S(a.d,"success "+r);d(c.rowsAffected)},function(b,c){P(a.d,"error: "+r+c.message);d(c,p);return s});g=0;for(f=e.indexes.length;g<f;g++)h=e.index(g),h.multiEntry&&(h="DELETE FROM  "+Qa("ydn.db.me:"+e.getName()+":"+h.getName())+m,S(a.d,"TX"+c+NaN+
h),b.executeSql(h,n))}v.Pa=function(a,b,c,d){function e(b){var j="SELECT COUNT(*) FROM "+Qa(d[b]);S(f.d,"SQL: "+j+" PARAMS: []");a.executeSql(j,[],function(a,m){var r=m.rows.item(0);g[b]=parseInt(r["COUNT(*)"],10);b++;S(f.d,b+". success "+j);b==d.length?c(g):e(b)},function(a,b){P(f.d,"error: "+j+" "+b.message);c(b,p);return s})}var f=this,g=[];0==d.length?(S(this.d,"success"),c(0)):e(0);return c};
v.ma=function(a,b,c,d,e,f,g){var h=this,j=[];d=$d(X(this.a,d),j,ge,f,e,s,g);var n="TX"+b+" SQL: "+d+" PARAMS: "+j;S(this.d,n);a.executeSql(d,j,function(a,b){var d=b.rows.item(0);S(h.d,"success "+n);c(he(d))},function(a,b){P(h.d,"error: "+n+b.message);c(b,p);return s});return c};var ie="serial parallel atomic-serial multirequest-serial samescope-multirequest-serial atomic-parallel multirequest-parallel samescope-multirequest-parallel open single".split(" ");function je(a){a?"abort"in a?a.abort():"executeSql"in a?a.executeSql("ABORT",[],aa(),ba(p)):k(new hd):k(new Xc("No active transaction"))};/*
 _try.
*/
function ke(a,b){this.g=a;this.f=b;this.b=[];this.za=this.e=q;this.a=new le(b)}ke.prototype.c=V("ydn.db.tr.Serial");ke.prototype.a=q;ke.prototype.t=function(){return this.a.b};ke.prototype.h=function(){return this.a.a&&!this.a.c?this.a.a:q};F("ydn.db.tr.Serial.prototype.getTx",ke.prototype.h);v=ke.prototype;v.za=q;v.type=function(){return this.g.k()};v.Sb=ba(s);v.abort=function(){Q(this.c,this+": aborting");je(this.za)};
v.pa=function(a,b,c,d){var e=a.name||"",f=B(b)?[b]:b;if(A(f)){0==f.length&&k(new K("number of store names must more than 0"));for(var g=0;g<f.length;g++)B(f[g])||k(new K("store name at "+g+" must be string but found "+f[g]+" of type "+typeof f[g]))}else k(new K("store names must be an array"));var h=x(c)?c:N,j=this;this.a.a||(!this.g.a||!this.g.a.bb())&&0<(this.e!==q)?(c=a,S(this.c,"Serial push tx queue "+c.name),this.b.push({ia:c,I:b,mode:h,H:d})):(this.e=d?[d]:[],this.g.transaction(function(c){var d=
j.a;d.a=c;d.c=s;d.I=b;d.mode=h;d.gb=e||"";d.b++;d.H=q;S(j.c,j+":tx"+j.a.b+J(b)+h+" begin");a(j);for(a=q;j.Sb();)c=j.b.shift(),c.H&&j.e.push(c.H),S(j.c,"pop tx queue in continue "+c.ia.name),c.ia()},f,h,function(a,b){S(j.c,j+":tx"+j.a.b+" committed with "+a);try{for(var c;c=j.e.shift();)c(a,b)}catch(d){k(d)}finally{if(c=j.a,c.a?(c.a=q,c.I=q,c.mode=q,fa(c.H)&&c.H(a,b),c.H=q):P(c.Qc,c+" has no TX to be unlocked for "+a),c=j.b.shift())S(j.c,"pop tx queue of "+j.b.length+" "+c.ia.name),j.pa(c.ia,c.I,c.mode,
c.H)}}))};v.Ib=ba(s);v.j=function(a,b,c,d,e,f){d=d||N;var g=this,h=this.a;if(h.a&&!h.c&&this.Ib(c,d)){var j=h.a,n=function(b,c){g.za=j;c?a.m(b):M(a,b);n=g.za=q};b(j,g.t(),n);b=q}else{var m=function(){function c(b,e){g.za=d;e?a.m(b):M(a,b);c=g.za=q}h.a||k(new Wc("Tx not active for scope: "+e));h.c&&k(new Wc("Tx not available for scope: "+e));m.name=e;var d=h.a;b(d,g.t(),c);b=q};g.pa(m,c,d,f)}};v.getName=function(){return this.g.getName()};
v.toString=function(){var a;a="Serial:"+this.g.getName();var b=this.a.gb;return a+":"+this.f+":"+this.t()+(b?" ["+b+"]":"")};function me(a,b){ke.call(this,a,b)}G(me,ke);me.prototype.c=V("ydn.db.tr.AtomicSerial");me.prototype.j=function(a,b,c,d,e,f){var g,h,j=new L;j.C(function(a){h=s;g=a},function(a){h=p;g=a});me.J.j.call(this,j,b,c,d,e,function(b,c){if(h===p)a.m(g);else if(h===s)M(a,g);else{var d=new dd;a.m(d)}f&&(f(b,c),f=l)})};function ne(a,b,c,d,e){x(e)||(e=y(a)?a.join(", "):a);a!=q&&(!B(a)&&!A(a))&&k(new K("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a));y(a)&&Object.freeze&&Object.freeze(a);!x(a)&&x(e)&&(a=e);this.keyPath=a;this.c=A(this.keyPath);this.name=e;this.type=oe(b);x(b)&&(x(this.type)||k(new K("type invalid in index: "+this.name)),y(this.keyPath)&&k(new K('composite key for store "'+this.name+'" must not specified type')));this.unique=!!c;this.multiEntry=!!d;this.f=B(this.type)?
this.type:pe;this.b=B(e)?e:y(a)?this.keyPath.join(","):a;this.a=Qa(this.b)}var pe="TEXT";function Aa(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return x(b)?a:Db(a)}
function Ud(a,b){var c;if("DATE"==b)c=new Date(a);else if(x(b))c=a;else{for(var d=c=[],e,f=[],g,h,j=new Jb(a);Hb(j)!=q;)if(0===j.a)d=f.pop();else{if(j.a===q)break;do{g=j.a/4|0;e=j.a%4;for(var n=0;n<g;n++)h=[],d.push(h),f.push(d),d=h;if(0===e&&12<j.a+4)Hb(j);else break}while(1);1===e?d.push(Gb(j)):2===e?d.push(new Date(Gb(j))):3===e?d.push(Ib(j)):0===e&&(d=f.pop())}c=c[0]}return c}var qe=["BLOB","DATE","INTEGER","NUMERIC",pe];function oe(a){if(B(a))return a=xa(qe,a),qe[a]}ne.prototype.getName=t("name");
ne.prototype.toJSON=function(){return{name:this.name,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};ne.prototype.e=function(){var a=y(this.keyPath)?db(this.keyPath):this.keyPath;return new ne(a,this.type,this.unique,this.multiEntry,this.name)};function re(a,b){return a==q&&b==q?q:a!=q?b!=q?A(a)&&A(b)?hb(a,b)?q:"expect: "+a+", but: "+b:se(a,b)?q:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b}
ne.prototype.hint=function(a){if(!a)return this;var b=y(this.keyPath)?db(this.keyPath):this.keyPath,c=this.type;!x(a.type)&&"TEXT"==c&&(c=l);return new ne(b,c,this.unique,this.multiEntry,a.name)};function te(a,b,c,d,e,f,g){this.name=a;B(this.name)||k(new K("store name must be a string"));this.keyPath=x(b)?b:q;this.keyPath!==q&&(!B(this.keyPath)&&!A(this.keyPath))&&k(new K("keyPath must be a string or array"));this.autoIncrement=c;var h;x(d)&&(h=oe(d),x(h)||k(new K("type invalid in store: "+this.name)),y(this.keyPath)&&k(new K('composite key for store "'+this.name+'" must not specified type')));this.type=x(h)?h:this.autoIncrement?"INTEGER":l;this.f=B(this.keyPath)?this.keyPath.split("."):[];
this.indexes=e||[];this.b=!!f;this.h=!!g;this.k=B(this.type)?this.type:pe;this.c=y(this.keyPath)?this.keyPath.join(","):B(this.keyPath)?this.keyPath:"_ROWID_";this.a=Qa(this.c)}te.prototype.b=s;te.prototype.h=s;te.prototype.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.name,keyPath:this.keyPath,autoIncrement:this.autoIncrement,type:this.type,indexes:a}};
function ue(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync".split(" "),c;for(c in a)a.hasOwnProperty(c)&&-1==xa(b,c)&&k(new K('Unknown attribute "'+c+'"'));b=[];c=a.indexes||[];if(y(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f=["name","unique","type","keyPath","multiEntry"],g=l;for(g in e)e.hasOwnProperty(g)&&-1==xa(f,g)&&k(new K("Unknown field: "+g+" in "+J(e)));e=new ne(e.keyPath,e.type,e.unique,e.multiEntry,e.name);x(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new te(a.name,
a.keyPath,a.autoIncrement,a.type,b,a.dispatchEvents,a.fixed)}var ae=1,be=2,ge=3;
function $d(a,b,c,d,e,f,g){var h=a.c,j=a.a,n=d!=q&&d!==h?Zd(a,d):q,m=!!n,r=Qa(d||h),u=m?n.type:a.type,z=m&&n.multiEntry,H="*",C=ee(a);g=g?"DISTINCT ":"";var T=[];z?(d=Qa("ydn.db.me:"+a.getName()+":"+n.getName()),H=c===ge?"COUNT("+g+d+"."+r+")":c===ae?ee(a)+"."+j+", "+d+"."+r:ee(a)+".*",C=d+" INNER JOIN "+ee(a)+" USING ("+j+")",e!=q&&(ya(d+"."+r,u,e,T,b),0<T.length&&(C+=" WHERE "+T.join(" AND ")))):(c===ge?H="COUNT("+j+")":c===ae&&(H=j,d!=q&&d!=h&&(H+=", "+r)),e!=q&&(ya(r,u,e,T,b),0<T.length&&(C+=
" WHERE "+T.join(" AND "))));a=f?"DESC":"ASC";r=r+" "+a;m&&(r+=", "+j+" "+a);return"SELECT "+H+" FROM "+C+" ORDER BY "+r}te.prototype.e=function(){return ue(this.toJSON())};te.prototype.index=function(a){return this.indexes[a]||q};function Zd(a,b){return $a(a.indexes,function(a){return a.name==b})}function ve(a,b){return b==a.keyPath?p:Za(a.indexes,function(a){return a.name==b})}function ee(a){return Qa(a.name)}
te.prototype.hint=function(a){if(!a)return this;var b=this.autoIncrement,c=y(this.keyPath)?db(this.keyPath):this.keyPath,d=this.type,e=Ya(this.indexes,function(a){return a.e()});!x(a.type)&&"TEXT"==d&&(d=l);y(a.keyPath)&&(B(c)&&c==a.keyPath.join(","))&&(c=db(a.keyPath));for(var f=0,g=a.indexes.length;f<g;f++)if(a.indexes[f].c)for(var h=a.indexes[f].getName(),j=e.length-1;0<=j;j--)if(0<=h.indexOf(e[j].getName())){e[j]=a.indexes[f].e();break}for(f=0;f<e.length;f++)(g=Zd(a,e[f].getName()))&&(e[f]=e[f].hint(g));
return new te(a.name,c,b,d,e)};te.prototype.getName=t("name");function we(a,b){if(E(b)){if(A(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++)c[d]=b[a.keyPath[d]];return c}if(a.keyPath)return Pb(b,a.f)}}function Xd(a,b,c){for(var d=0;d<a.f.length;d++){var e=a.f[d];if(d==a.f.length-1){b[e]=c;break}x(b[e])||(b[e]={});b=b[e]}}
function de(a,b,c){var d=[],e=[];c=x(c)?c:we(a,b);x(c)&&(e.push(a.a),d.push(Aa(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&!(g.name===a.keyPath||"_default_"==g.name)){var h;h=g;var j=b;if(j!=q)if(A(h.keyPath)){for(var n=[],m=0,r=h.keyPath.length;m<r;m++){var u=Ab(j,h.keyPath[m]);n[m]=u}h=n}else h=Ab(j,h.keyPath);else h=l;h!=q&&(d.push(Aa(h,g.type)),e.push(g.a))}}a.h||(d.push(J(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Mb:e,bc:a,
B:d,key:c}}
function xe(a,b){if(!b)return"missing store: "+a.name;if(a.name!=b.name)return"store name, expect: "+a.name+", but: "+b.name;var c=re(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(x(a.autoIncrement)&&x(b.autoIncrement)&&a.autoIncrement!=b.autoIncrement)return"autoIncrement, expect:  "+a.autoIncrement+", but: "+b.autoIncrement;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(x(a.type)&&x(b.type)&&(A(a.type)?!hb(a.type,b.type):
a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=Zd(b,a.indexes[c].name),e;e=a.indexes[c];if(d)if(e.name!=d.name)e="name, expect: "+e.name+", but: "+d.name;else{var f=re(e.keyPath,d.keyPath);e=f?"keyPath, "+f:e.unique!=q&&d.unique!=q&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:e.multiEntry!=q&&d.multiEntry!=q&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:x(e.type)&&x(d.type)&&
(A(e.type)?!hb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.name;if(0<e.length)return'index "'+a.indexes[c].name+'" '+e}return""};function ye(a,b){var c,d=b;if(E(a)){c=["version","stores"];for(var e in a)a.hasOwnProperty(e)&&-1==xa(c,e)&&k(new K("Unknown field: "+e+" in schema."));c=a.version;d=[];e=a.stores||[];y(e)||k(new K("stores must be array"));for(var f=0;f<e.length;f++){var g=ue(e[f]);-1!=ab(d,function(a){return a.name==g.name})&&k(new K('duplicate store name "'+g.name+'".'));d.push(g)}}else B(a)?c=0==a.length?l:parseFloat(a):D(a)&&(c=a);x(c)&&((!D(c)||0>c)&&k(new K("Invalid version: "+c+" ("+a+")")),isNaN(c)&&(c=l));
x(b)&&(!y(b)||0<b.length&&!(b[0]instanceof te))&&k(new K("stores"));this.version=c;this.b=!x(this.version);this.stores=d||[]}ye.prototype.toJSON=function(){var a=this.stores.map(function(a){return a.toJSON()});return{version:this.version,stores:a}};ye.prototype.b=s;ye.prototype.a=ba(s);function ze(a){return a.stores.map(function(a){return a.name})}ye.prototype.c=function(a){return this.stores[a]||q};function X(a,b){return $a(a.stores,function(a){return a.name==b})}
function Ae(a,b){return Za(a.stores,function(a){return a.name==b})}function Be(a,b,c){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var d=0;d<a.stores.length;d++){var e=X(b,a.stores[d].name),e=e&&c?e.hint(a.stores[d]):e,e=xe(a.stores[d],e);if(0<e.length)return'store: "'+a.stores[d].name+'" '+e}return""};function Ce(a,b){x(a)&&5242880<a&&P(this.l,"storage size request ignored, use Quota Management API instead");this.n=q;this.Ja=b||NaN}
Ce.prototype.ra=function(a,b){function c(a,c,d){Q(e.l,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)De(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Ae(b,c[d])||(a.deleteObjectStore(c[d]),Q(e.l,"store: "+c[d]+" deleted."))}function d(a,b){f.ea?P(e.l,"database already set."):x(b)?(P(e.l,b?b.message:"Error received."),e.n=q,f.m(b)):(e.n=a,e.n.onabort=function(a){S(e.l,e+": onabort - "+a.message)},e.n.onerror=function(a){S(e.l,
e+": onerror - "+a.message)},e.n.onversionchange=function(a){S(e.l,e+": onversionchange to: "+a.version);e.n&&(e.n.onabort=q,e.n.onerror=q,e.n.onversionchange=q,e.n.close(),e.n=q,fa(e.b)&&e.b())},M(f,parseFloat(g)))}var e=this,f=new L,g=l,h=b.version;Q(e.l,"Opening database: "+a+" ver: "+(b.b?"auto":h));var j;j=x(h)?Ee.open(a,h):Ee.open(a);j.onsuccess=function(f){var h=f.target.result;x(g)||(g=h.version);Q(e.l,"Database: "+h.name+", ver: "+h.version+" opened.");if(b.b)e.ba(function(f){if(b.a())for(var g=
0;g<f.stores.length;g++)if(!Ae(b,f.stores[g].getName())){var j=f.stores[g].e();b.stores.push(j)}f=Be(b,f);if(0<f.length){Q(e.l,"Schema change require for difference in "+f);var n=D(h.version)?h.version+1:1;if("IDBOpenDBRequest"in w){h.close();var r=Ee.open(a,n);r.onupgradeneeded=function(a){a=a.target.result;Q(e.l,"re-open for version "+a.version);c(a,r.transaction,s)};r.onsuccess=function(a){d(a.target.result)};r.onerror=function(){Q(e.l,e+": fail.");d(q)}}else{var R=h.setVersion(n+"");R.a=function(a){P(e.l,
"migrating from "+h.version+" to "+n+" failed.");d(q,a)};R.onsuccess=function(){R.transaction.oncomplete=U;c(h,R.transaction,p)};var U=function(){var b=Ee.open(a);b.onsuccess=function(a){a=a.target.result;Q(e.l,e+": OK.");d(a)};b.onerror=function(){Q(e.l,e+": fail.");d(q)}};R.transaction!=q&&(R.transaction.oncomplete=U)}}else d(h)},l,h);else if(b.version>h.version){var j=h.setVersion(b.version);j.a=function(a){P(e.l,"migrating from "+h.version+" to "+b.version+" failed.");d(q,a)};j.onsuccess=function(){c(h,
j.transaction,p)}}else b.version==h.version?Q(e.l,"database version "+h.version+" ready to go"):P(e.l,"connected database version "+h.version+" is higher than requested version."),e.ba(function(a){a=Be(b,a);0<a.length?(Q(e.l,a),d(q,new kd("different schema: "+a))):d(h)},l,h)};j.onupgradeneeded=function(a){a=a.target.result;g=NaN;Q(e.l,"upgrade needed for version "+a.version);c(a,j.transaction,s)};j.onerror=function(c){Gc(e.l,"opening database "+a+":"+b.version+" failed.");d(q,c)};j.onblocked=function(c){Gc(e.l,
"database "+a+" "+b.version+" block, close other connections.");d(q,c)};D(this.Ja)&&!isNaN(this.Ja)&&Nd(function(){"done"!=j.readyState&&(Gc(e.l,e+": database state is still "+j.readyState),d(q,new dd("connection timeout after "+e.Ja)))},this.Ja);return f};var Ee=w.indexedDB||w.mozIndexedDB||w.webkitIndexedDB||w.moz_indexedDB||w.msIndexedDB;v=Ce.prototype;v.Ja=18E4;v.sa=ba("indexeddb");v.Cb=function(){return this.n||q};v.bb=function(){return!!this.n};v.l=V("ydn.db.con.IndexedDb");v.n=q;
v.Db=function(){return this.n?parseFloat(this.n.version):l};
v.ba=function(a,b,c){c=c||this.n;if(x(b)){if(b===q){if(0==c.objectStoreNames.length){a(new ye(c.version));return}k(new jd)}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new ye(c.version));return}b=c.transaction(b,N)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var h=b.objectStore(e[d]),j=[],n=0,m=h.indexNames.length;n<m;n++){var r=h.index(h.indexNames[n]);j[n]=new ne(r.keyPath,l,r.unique,r.multiEntry,r.name)}f[d]=new te(h.name,
h.keyPath,h.autoIncrement,l,j)}b=new ye(c.version,f);a(b)};
function De(a,b,c,d){function e(){var a={autoIncrement:!!d.autoIncrement};d.keyPath!=q&&(a.keyPath=d.keyPath);try{return b.createObjectStore(d.getName(),a)}catch(c){"InvalidAccessError"==c.name&&k(new Yc("creating store for "+d.getName()+" of keyPath: "+d.keyPath+" and autoIncrement: "+d.autoIncrement)),"ConstraintError"==c.name&&k(new kd("creating store for "+d.getName())),k(c)}}S(a.l,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName()))if(c=
c.objectStore(d.getName()),(d.keyPath||"")!=(c.keyPath||""))b.deleteObjectStore(d.getName()),P(a.l,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(ea(c.autoIncrement)&&ea(d.autoIncrement)&&c.autoIncrement!=d.autoIncrement)b.deleteObjectStore(d.getName()),P(a.l,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,h=0,j=0;j<d.indexes.length;j++){var n=d.indexes[j];if(!f.contains(n.name)){if(n.unique||n.multiEntry){var m={unique:n.unique,
multiEntry:n.multiEntry};c.createIndex(n.name,n.keyPath,m)}else c.createIndex(n.name,n.keyPath);g++}}for(j=0;j<f.length;j++)ve(d,f[j])||(c.deleteIndex(f[j]),h++);S(a.l,"Updated store: "+c.name+", "+g+" index created, "+h+" index deleted.")}else{c=e();for(j=0;j<d.indexes.length;j++)n=d.indexes[j],S(a.l,"Creating index: "+n.name+" multiEntry: "+n.multiEntry),n.unique||n.multiEntry?(m={unique:n.unique,multiEntry:n.multiEntry},c.createIndex(n.name,n.keyPath,m)):c.createIndex(n.name,n.keyPath);S(a.l,"Created store: "+
c.name+" keyPath: "+c.keyPath)}}v.Qa=function(a,b,c,d){var e=this.n;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(q):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onerror=function(a){d("error",a)},b.onabort=function(a){d("abort",a)},a(b),a=q)};v.ab=function(){this.n.close()};v.toString=function(){return this.sa()+":"+(this.n?this.n.name+":"+this.n.version:"")};function Fe(a){this.a=x(a)?a:4194304}v=Fe.prototype;
v.ra=function(a,b){function c(a,b){x(b)?(d.A=q,f.m(b)):(d.A=a,M(f,parseFloat(e)))}var d=this,e=NaN,f=new L,g=q;try{g=w.openDatabase(a,"",a,this.a)}catch(h){"SECURITY_ERR"==h.name?(P(this.o,"SECURITY_ERR for opening "+a),g=q,this.Eb=new bd(h)):k(h)}if(g){var e=g.version,j="database "+a+(0==g.version.length?"":" version "+g.version);b.version!=q&&b.version==g.version?(Hc(d.o,"Existing "+j+" opened as requested."),c(g)):this.ba(function(e){if(e=Be(b,e,p)){0==g.version.length?Hc(d.o,"New "+j+" created."):
b.b?Hc(d.o,"Existing "+j+" opened and  schema change for "+e):Hc(d.o,"Existing "+j+" opened and  schema change to version "+b.version+" for "+e);var f=g;e=f.version?parseInt(f.version,10):0;e=b.b?isNaN(e)?1:e+1:b.version;S(d.o,a+": changing version from "+f.version+" to "+e);var h=s,u=0;f.changeVersion(f.version,e+"",function(a){d.ba(function(c){h=p;for(var e=0;e<b.stores.length;e++){var f=X(c,b.c(e).getName()),f=f?f.hint(b.c(e)):q;Ge(d,a,b.c(e),function(a){a&&u++},f)}if(b instanceof He)for(e=0;e<
c.stores.length;e++)f=c.c(e),Ae(b,f.getName())||b.stores.push(f)},a,f)},function(a){k(a)},function(){if(h){var e=".";u!=b.stores.length&&(e=" but unexpected stores exists.");S(d.o,a+":"+f.version+" ready"+e);c(f)}else P(d.o,a+": changing version voided.")})}else Hc(d.o,"Existing "+j+" with same schema opened."),c(g)},q,g)}else c(q,this.Eb);return f};v.sa=ba("websql");v.Eb=q;v.A=q;v.Cb=function(){return this.A||q};v.o=V("ydn.db.con.WebSql");
v.Db=function(){return this.A?parseFloat(this.A.version):l};
v.ba=function(a,b,c){function d(a,b){k(b)}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var u;u="sql"in e?e.sql:l;S(f.o,"Parsing table schema from SQL: "+u);var z=u.substr(u.indexOf("("),u.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),H=l,C;u=[];for(var T=s,R=s,U=0;U<z.length;U++){var ja=z[U].match(/\w+|"[^"]+"/g),Va=Ya(ja,function(a){return a.toUpperCase()}),Ka=Na(ja[0],'"'),
ja=oe(Va[1]);if(-1!=Va.indexOf("PRIMARY")&&-1!=Va.indexOf("KEY"))B(Ka)&&(!/^[\s\xa0]*$/.test(Ka)&&"_ROWID_"!=Ka)&&(H=Ka),C=ja,-1!=Va.indexOf("AUTOINCREMENT")&&(T=p);else if("_default_"==Ka)R=p;else{var fb="UNIQUE"==Va[2],Va=new ne(Ka,ja,fb);u.push(Va)}}if(Ca(e.name,"ydn.db.me:"))if((z=e.name.split(":"))&&3<=z.length){var pb=z[1],H=ab(h,function(a){return a.getName()===pb}),z=new ne(z[2],ja,fb,p);0<=H?(U=h[H],u.push(z),h[H]=new te(U.getName(),U.keyPath,T,C,u,l,!R)):h.push(new te(pb,l,s,l,[z]))}else P(f.o,
'Invalid multiEntry store name "'+e.name+'"');else z=ab(h,function(a){return a.getName()===e.name}),0<=z?(U=h[z].index(0),u.push(U),h[z]=new te(e.name,H,T,C,u,l,!R)):(u=new te(e.name,H,T,C,u,l,!R),h.push(u))}}d=new ye(g,h);a(d)}}var f=this,g=(c=c||this.A)&&c.version?parseFloat(c.version):l,g=isNaN(g)?l:g,h=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.ba(a,b,c)},function(a){Gc(f.o,"opening tx: "+a.message);k(a)},e)};
function Ge(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==h.length&&(d(p),d=q)},function(b,e){g++;g==h.length&&(d(s),d=q);k(new ad(e,"SQLError creating table: "+c.name+" "+e.message+' for executing "'+a))})}var g=0,h,j=c.k,n="CREATE TABLE IF NOT EXISTS "+ee(c)+" (",m=c.a,n=n+(m+" "+j+" PRIMARY KEY ");c.autoIncrement&&(n+=" AUTOINCREMENT ");for(var n=n+" ,_default_ BLOB",r=[],u=[m],z=0,H=c.indexes.length;z<H;z++){var C=c.index(z),T="";if(C.multiEntry)T=C.unique?" UNIQUE ":"",C="CREATE TABLE IF NOT EXISTS "+
Qa("ydn.db.me:"+c.getName()+":"+C.getName())+" ("+m+" "+j+", "+C.a+" "+C.f+T+")",r.push(C);else{C.unique&&(T=" UNIQUE ");var R=C.a;-1==u.indexOf(R)&&(n+=", "+R+" "+C.f+T,u.push(R))}}r.push(n+");");h=r;j="Create";if(e){e=xe(c,e);if(0==e.length){S(a.o,"same table "+c.name+" exists.");d(p);d=q;return}j="Modify";P(a.o,"table: "+c.name+" has changed by "+e+" additionallly TABLE ALTERATION is not implemented, dropping old table.");h.unshift("DROP TABLE IF EXISTS "+Qa(c.name))}S(a.o,j+" table: "+c.name+
": "+h.join(";"));for(a=0;a<h.length;a++)f(h[a])}v.bb=function(){return!!this.A};v.ab=aa();v.Qa=function(a,b,c,d){function e(a){S(h.o,h+": Tx "+c+" request cause error.");d("error",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var h=this;this.A===q&&(a(q),d("error",this.Eb));c==N?this.A.readTransaction(g,e,f):c==yb?this.A.changeVersion(this.A.version,this.A.version+1+"",g,e,f):this.A.transaction(g,e,f)};var za=Ee&&Ee.cmp?na(Ee.cmp,Ee):Kb;function Ie(a,b,c,d){this.g=a;this.b=b;this.a=d;this.e=c;this.c=q}Ie.prototype.i=V("ydn.db.tr.DbOperator");Ie.prototype.t=function(){return this.a.t()};Ie.prototype.abort=function(){this.a.abort()};function Y(a){a.c||(a.c=a.g.ub(a.e));return a.c}Ie.prototype.toString=function(){return"TxStorage:"+this.g.getName()};function Je(a,b,c,d){Ie.call(this,a,b,c,d)}G(Je,Ie);v=Je.prototype;v.i=V("ydn.db.crud.DbOperator");
v.ta=function(a,b,c,d){var e=vb(),f=this,g,h,j;if(x(a))if(y(a)){(x(c)||x(b))&&k(new K("too many arguments."));g=a;for(c=0;c<g.length;c++)Ae(this.b,g[c])||k(new K('store name "'+g[c]+'" at '+c+" not found."));Q(this.i,"countStores: "+J(g));this.a.j(e,function(a,b,c){Y(f).Pa(a,b,c,g)},g,N,"countStores")}else B(a)?(Ae(this.b,a)||k(new K('store name "'+a+'" not found.')),x(d)&&!ea(d)&&k(new TypeError('unique value "'+d+'" must be boolean, but found '+typeof d+".")),g=[a],B(b)?(h=b,(b=wa(b))&&k(new K("invalid key range: "+
md(c)+" "+b)),j=ua(c)):E(b)||!x(b)?(x(c)&&k(new K('Invalid key range "'+md(c)+'"')),(a=wa(b))&&k(new K("invalid key range: "+md(c)+" "+a)),j=ua(b)):k(new K("key range must be an object, but "+md(c)+" of type "+typeof b+" found.")),Q(this.i,"countKeyRange: "+g[0]+" "+(h?h:"")+J(j)),this.a.j(e,function(a,b,c){Y(f).ma(a,b,c,g[0],j,h,!!d)},g,N,"countKeyRange")):k(new K("Invalid store name or store names."));else{(x(c)||x(b))&&k(new K("too many arguments."));g=ze(this.b);var n=new L;Q(this.i,"countStores: "+
J(g));this.a.j(e,function(a,b,c){Y(f).Pa(a,b,c,g)},g,N,"countStores");e.C(function(a){a=a.reduce(function(a,b){return b+a},0);M(n,a)},function(a){n.m(a)});return n}return e};
v.ua=function(a,b){var c=this,d=vb();if(a instanceof ed){var e=a.a;if(!Ae(this.b,e)){if(this.b.a())return tb(l);k(new K("Store: "+e+" not found."))}var f=a.id;Q(this.i,"getById: "+e+":"+f);this.a.j(d,function(a,b,d){Y(c).Sa(a,b,d,e,f)},[e],N,"getById")}else if(B(a)&&x(b)){if(!X(this.b,a)){if(this.b.a())return tb(l);k(new K('Store name "'+a+'" not found.'))}if(b instanceof va||b instanceof I){var g=new L;g.C(function(a){M(d,a[0])},function(a){d.m(a)});var h=wa(b);h&&k(new K("invalid key range: "+b+
" "+h));var j=ua(b);Q(this.i,"getById: "+a+":"+J(j));this.a.j(g,function(b,d,e){Y(c).Ha(b,d,e,a,j,s,1,0)},[a],N,"getById")}else Q(this.i,"getById: "+a+":"+b),this.a.j(d,function(d,e,f){Y(c).Sa(d,e,f,a,b)},[a],N,"getById")}else k(new K("get require valid input arguments."));return d};
v.keys=function(a,b,c,d,e,f){var g=this,h,j,n=q,m=s,r=X(this.b,a);B(a)||k(new K("store name must be a string, but "+a+" of type "+typeof a+" is not."));this.b.a()||(r||k(new K('store name "'+a+'" not found.')),B(b)&&!Zd(r,b)&&k(new K('index "'+b+'" not found in store "'+a+'".')));if(this.b.a()&&!r)return tb([]);r=new L;if(B(b)){var u=wa(c);u&&k(new K("invalid key range: "+c+" "+u));n=ua(c);D(d)?h=d:(x(d)&&k(new K("limit must be a number")),h=100);D(e)?j=e:(x(e)&&k(new K("offset must be a number")),
j=0);x(f)&&(ea?m=f:k(new K("reverse must be a boolean")));Q(this.i,"keysByIndexKeyRange: "+a);this.a.j(r,function(c,d,e){Y(g).Tb(c,d,e,a,b,n,m,h,j,s)},[a],N,"keysByIndexKeyRange")}else(u=wa(b))&&k(new K("invalid key range: "+b+" "+u)),n=ua(b),D(c)?h=c:(x(c)&&k(new K("limit must be a number")),h=100),D(d)?j=d:(x(d)&&k(new K("offset must be a number")),j=0),x(e)&&(ea(e)?m=e:k(new K("reverse must be a boolean"))),Q(this.i,"keysByKeyRange: "+a),this.a.j(r,function(b,c,d){Y(g).Ub(b,c,d,a,n,m,h,j)},[a],
N,"keysByKeyRange");return r};
v.B=function(a,b,c,d,e,f){var g=this,h=vb(),j,n,m=s;if(B(a)){if(!X(this.b,a)){if(this.b.a())return tb([]);k(new Zc(a))}if(y(b))(x(c)||x(d))&&k(new K("too many input arguments")),Q(this.i,"listByIds: "+a+" "+b.length+" ids"),this.a.j(h,function(c,d,e){Y(g).sb(c,d,e,a,b)},[a],N,"listByIds");else if(B(b)){var r=wa(c);r&&k(new K("invalid key range: "+c+" "+r));var u=ua(c);x(d)?D(d)?j=d:k(new K("limit must be a number.")):j=100;x(e)?D(e)?n=e:k(new K("offset must be a number.")):n=0;ea(f)?m=f:x(f)&&k(new K("reverse must be a boolean, but "+
f));Q(this.i,"listByIndexKeyRange: "+a+":"+b);this.a.j(h,function(c,d,e){Y(g).Ga(c,d,e,a,b,u,m,j,n,s)},[a],N,"listByIndexKeyRange")}else(r=wa(b))&&k(new K("invalid key range: "+b+" "+r)),u=ua(b),x(c)?D(c)?j=c:k(new K("limit must be a number, but "+c+" is "+typeof c)):j=100,x(d)?D(d)?n=d:k(new K("offset must be a number, but "+d+" is "+typeof d)):n=0,x(e)&&(ea(e)?m=e:k(new K("reverse must be a boolean, but "+e+" is "+typeof e))),Q(this.i,(u?"listByKeyRange: ":"listByStore: ")+a),this.a.j(h,function(b,
c,d){Y(g).Ha(b,c,d,a,u,m,j,n)},[a],N,"listByKeyRange")}else if(y(a))if(a[0]instanceof ed){c=[];for(d=0;d<a.length;d++){e=a[d].a;if(!Ae(this.b,e)){if(this.b.a())return h=[],h[a.length-1]=l,tb(h);k(new K("Store: "+e+" not found."))}0<=xa(c,e)||c.push(e)}Q(this.i,"listByKeys: "+J(c)+" "+a.length+" keys");this.a.j(h,function(b,c,d){Y(g).tb(b,c,d,a)},c,N,"listByKeys")}else k(new K("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found."));else k(new K("first argument "+a+" is invalid."));
return h};
v.cb=function(a,b,c){var d=B(a)?a:E(a)?a.name:l;B(d)||k(new K("store name "+d+" must be a string, but "+typeof d));var e=X(this.b,d);e?this.b.a()&&E(a)&&(a=ue(a),(a=xe(e,a))&&k(new hd("schema change: "+a))):(this.b.a()||k(new K('store name "'+d+'" not found.')),e=ue(E(a)?a:{name:d}),Q(this.i,"Adding object store: "+d),Ke(this.g,e));a=vb();var f=this;e||k(new K('store name "'+d+'" not found.'));B(e.keyPath)&&x(c)&&k(new K("key cannot provide while in-line key is in used."));e.autoIncrement&&x(c)&&
k(new K("key cannot provide while autoIncrement is true."));!B(e.keyPath)&&(!e.autoIncrement&&!x(c))&&k(new K("out-of-line key must be provided."));if(y(b))Q(this.i,"addObjects: "+d+" "+b.length+" objects"),this.a.j(a,function(a,e,g){Y(f).kb(a,e,g,d,b,c)},[d],O,"putObjects"),e.b&&a.ca(function(a){Md(f.g,new Le(Me,f.g,e.getName(),a,b))});else if(E(b)){var g="store: "+d+" key: "+!!e.keyPath?we(e,b):c;Q(this.i,"addObject: "+g);this.a.j(a,function(a,e,g){Y(f).jb(a,e,g,d,b,c)},[d],O,"putObject");e.b&&
a.ca(function(a){Md(f.g,new Ne(Me,f.g,e.getName(),a,b))})}else k(new K("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found."));return a};
v.va=function(a,b,c){var d=vb(),e=this;if(a instanceof ed){var d=a.a,f=X(this.b,d);f||k(new K('store "'+d+'" not found.'));if(f.keyPath){var g=we(f,b);g!=q?0!=za(g,a.id)&&k(new K("Inline key must be "+a+" but "+g+" found.")):Xd(f,b,a.id);return this.va(d,b)}return this.va(d,b,a.id)}if(y(a)){x(c)&&k(new K("too many arguments"));x(b)||k(new K("record values required"));for(var f=[],g=0,h=a.length;g<h;g++){var j=a[g].a;-1==xa(f,j)&&f.push(j);var n=X(this.b,j);n||k(new K('store "'+j+'" not found.'));
n.keyPath&&Xd(n,b[g],a[g].id)}Q(this.i,"putByKeys: to "+J(f)+" "+b.length+" objects");this.a.j(d,function(c,d,f){Y(e).Yb(c,d,f,b,a)},f,O,"putByKeys")}else if(B(a)||E(a)){f=B(a)?a:E(a)?a.name:l;B(f)||k(new K("store name must be a string"));(g=X(this.b,f))?this.b.a()&&E(a)&&(h=ue(a),(h=xe(g,h))&&k(new hd("schema change: "+h))):(this.b.a()||k(new Zc(f)),g=ue(E(a)?a:{name:f}),Q(this.i,"Adding object store: "+f),Ke(this.g,g));g||k(new Zc(f));var n=g,m=n.getName();n.keyPath&&x(c)&&k(new K("key cannot provide while in-line key is in used."));
n.autoIncrement&&x(c)&&k(new K("key cannot provide while autoIncrement is true."));!n.keyPath&&(!n.autoIncrement&&!x(c))&&k(new K("out-of-line key must be provided."));y(b)?(Q(this.i,"putObjects: "+m+" "+b.length+" objects"),this.a.j(d,function(a,d,f){Y(e).xb(a,d,f,m,b,c)},[m],O,"putObjects"),n.b&&d.ca(function(a){Md(e.g,new Le(Oe,e.g,m,a,b))})):E(b)?(Q(this.i,"putObject: "+m+" "+c),this.a.j(d,function(a,d,f){Y(e).wb(a,d,f,m,b,c)},[m],O,"putObject"),n.b&&d.ca(function(a){Md(e.g,new Ne(Oe,e.g,m,a,
b))})):k(new K("put record value must be Object or array of Objects"))}else k(new K("the first argument of put must be store name, store schema or array of keys."));return d};
v.clear=function(a,b,c){x(c)&&k(new K("too many input arguments"));c=vb();var d=this;if(B(a))if(X(this.b,a)||k(new K('store name "'+a+'" not found.')),E(b)){var e=ua(b);e===q&&k(new K("clear method requires a valid non-null KeyRange object."));Q(this.i,"clearByKeyRange: "+a+":"+J(e));this.a.j(c,function(b,c,f){Y(d).Lb(b,c,f,a,e)},[a],O,"clearByKeyRange")}else x(b)&&k(new K("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+typeof b)),Q(this.i,"clearByStore: "+
a),this.a.j(c,function(b,c,e){Y(d).Oa(b,c,e,[a])},[a],O,"clearByStores");else if(!x(a)||y(a)&&B(a[0])){var f=a||ze(this.b);Q(this.i,"clearByStores: "+J(f));this.a.j(c,function(a,b,c){Y(d).Oa(a,b,c,f)},f,O,"clearByStores")}else k(new K('first argument "'+a+'" is invalid.'));return c};
v.eb=function(a,b,c){var d=vb(),e=this;if(B(a)){var f=X(this.b,a);f||k(new K('store name "'+a+'" not found.'));if(x(c))if(B(b)){var g=Zd(f,b);g||k(new K("index: "+b+" not found in "+a));if(E(c)||c===q){var h=ua(c);Q(this.i,"removeByIndexKeyRange: "+a+":"+g.getName()+" "+a);this.a.j(d,function(b,c,d){Y(e).Zb(b,c,d,a,g.getName(),h)},[a],O,"removeByIndexKeyRange")}else k(new K("key range "+c+' is invalid type "'+typeof c+'".'))}else k(new K('index name "'+b+'" must be a string, but '+typeof b+" found."));
else B(b)||D(b)||b instanceof DOMStringList||y(b)||b instanceof Date?(Q(this.i,"removeById: "+a+":"+b),this.a.j(d,function(c,d,f){Y(e).yb(c,d,f,a,b)},[a],O,"removeById"),f.b&&d.ca(function(b){Md(e.g,new Ne(Pe,e.g,a,b,l))})):E(b)?(h=ua(b),Q(this.i,"removeByKeyRange: "+a+":"+J(h)),this.a.j(d,function(b,c,d){Y(e).$b(b,c,d,a,h)},[a],O,"removeByKeyRange"),f.b&&d.ca(function(b){Md(e.g,new Le(Pe,e.g,a,b,l))})):k(new K('Invalid key or key range "'+b+'" of type '+typeof b))}else k(new K('store name required, but "'+
a+'" of type '+typeof a+" found."));return d};v.toString=function(){return"DbOperator:"+this.g.getName()};F("ydn.db.con.IStorage.prototype.transaction",aa().prototype.transaction);function Qe(a,b,c,d){"transaction"in a?(this.q=a,this.f=this.k=q):"objectStore"in a?(this.q=q,this.k=a.db,this.f=a,this.f.db.objectStoreNames.contains(b)||k(new gd('store "'+b+'" not in transaction.'))):k(new gd("storage instance require."));this.Y=b;this.fa=c;this.U=d;this.e=[];this.c=0;this.h=s}Qe.prototype.b=V("ydn.db.con.IdbCursorStream");Qe.prototype.h=s;Qe.prototype.e=[];function Re(a,b,c){E(a)&&"transaction"in a?(this.Ma=a,this.ha=q):E(a)&&"db"in a?(this.Ma=q,Se(this,a)):k(new K("ydn.db.Streamer: First argument requires storage or transaction instance required."));B(b)||k(new K("a store name required."));this.a=b;x(c)&&!B(c)&&k(new K("index name must be a string."));this.qa=c;this.ha=q;this.Z=[];this.ka=[];this.Ea=s}v=Re.prototype;v.Ma=q;v.g=q;v.Bb=q;v.ka=[];v.Z=[];v.ha=q;v.ac=function(a){this.Bb=a};
function Se(a,b){"db"in b?a.ha=new Qe(b,a.a,a.qa,na(a.da,a)):k(new K("Invalid IndexedDB Transaction."))}function Te(a){var b=0<a.Z.length;if(b&&!a.Ea&&fa(a.Bb)){var c=function(){Te(a)},d=a.ka.shift(),e=a.Z.shift(),b=0<a.Z.length,c=a.Bb(d,e,b?c:q);b&&!c&&Te(a)}}v.Ea=s;v.qc=function(a){if(this.ha){this.Ea=p;var b=this,c=this.ha,d=function(){a(b.ka,b.Z);b.ka=[];b.Z=[];b.Ea=s};0==c.e.length&&0==c.c?d():c.da=d}else a(this.ka,this.Z),this.ka=[],this.Z=[]};
v.da=function(a,b){this.ka.push(a);this.Z.push(b);Te(this)};
v.push=function(a,b){this.Ea&&k(new Tc("push not allowed after a collection is started"));if(2<=arguments.length)this.da(a,b);else{if(!this.ha){this.Ma||k(new Tc("Database is not setup."));var c=this.Ma.k();c?"indexeddb"===c?this.ha=new Qe(this.Ma,this.a,this.qa,na(this.da,this)):k(new id(c)):k(new Tc("Database is not connected."))}var d=this.ha;d.e.push(a);if(!d.h){var e=function(a,b){d.f=q;"complete"!==a&&P(d.b,b.name+":"+b.message);S(d.b,d+" transaction "+a)},f=function(a){var b=d.e.shift();S(d.b,
d+" transaction started for "+b);var c=a.objectStore(d.Y).openCursor(b);d.c++;c.onsuccess=function(a){if(a=a.target.result){if(fa(d.U)){var b=a.value;d.U(a.primaryKey,d.fa!=q?b[d.fa]:b)}else P(d.b,"sink gone, dropping value for: "+a.primaryKey);if(a&&0<d.e.length)a["continue"](d.e.shift());else d.c--,0==d.c&&d.da&&d.da()}};c.onerror=function(){P(d.b,"seeking fail. "+("error"in c?c.error.name+":"+c.error.message:""));d.c--;0==d.c&&d.da&&d.da()}};d.f?(S(d.b,d+" using existing tx."),f(d.f)):d.k?(S(d.b,
d+" creating tx from IDBDatabase."),d.a=d.k.transaction([d.Y],N),d.a.oncomplete=function(a){e("complete",a)},d.a.onerror=function(a){e("error",a)},d.a.onabort=function(a){e("abort",a)}):d.q?(S(d.b,d+" creating tx from ydn.db.con.IStorage."),d.h=p,d.q.transaction(function(a){d.h=s;f(a)},[d.Y],N,e)):k(new jd("no way to create a transaction provided."))}}};v.Ba=t("qa");v.toString=function(){return"Streamer:"+this.a+(this.qa||"")};function Ue(a,b,c,d,e,f,g){pd.call(this);this.Gb=c;this.c=d;this.f=B(this.c);this.G=e;this.a=a;this.U=b;this.reverse="prev"==f||"prevunique"==f;this.unique="nextunique"==f||"prevunique"==f;this.W=f;this.Va=g}G(Ue,pd);v=Ue.prototype;v.Gb="";v.W="";v.G=q;v.unique=s;v.reverse=s;v.Va=p;v.V=function(a){k(a)};v.kc=function(){return this.f?this.Fb():this.r()};v.v=function(a,b,c){this.u(a,b,c)};v.u=aa();v.T=s;v.oa=function(){this.a=q};
v.toString=function(){var a="";this.X()&&(a=this.f?" {"+this.kc()+":"+this.r()+"} ":" {"+this.r()+"} ");return(this.a?"":"~")+" TX"+this.U+" Cursor:"+a+this.Gb+(x(this.c)?":"+this.c:"")};function Ve(a,b){a!=q&&!("push"in a)&&k(new gd);this.a=a||q;this.h=b;this.f=0}Ve.prototype.k=V("ydn.db.algo.AbstractSolver");Ve.prototype.a=q;Ve.prototype.b=function(a){y(a)||k(new TypeError("iterators must be array"));2>a.length&&k(new RangeError("ZigzagMerge require at least 2 iterators, but  only "+a.length+" found."));for(var b=0;b<a.length;b++)a[b]instanceof W||k(new TypeError("item at iterators "+b+" is not an iterator."));return s};Ve.prototype.c=function(){return[]};function We(a,b,c,d,e,f,g){Ue.call(this,a,b,c,d,e,f,g);this.P=this.K=this.p=q;this.$=s}G(We,Ue);v=We.prototype;v.xa=V("ydn.db.index.req.IDBCursor");v.p=q;
v.xc=function(a){var b="IDB"+this;if(this.p=a=a.target.result){if(this.P!=q){b=Ee.cmp(a.key,this.P);if(1===b){this.P=this.K=q;this.v(a.primaryKey,a.key,a.value);return}if(0===b)this.P=q;else{a["continue"]();return}}if(this.K!=q)if(b=Ee.cmp(this.K,a.primaryKey),0===b)this.K=q,this.$?(this.$=s,a["continue"]()):this.v(a.primaryKey,a.key,a.value);else if(1===b)a["continue"]();else this.K=q,this.v(a.primaryKey,a.key,a.value);else this.v(a.primaryKey,a.key,a.value)}else this.K=this.P=q,this.$=s,S(this.xa,
b+" completed."),this.v(l,l,l)};v.K=q;v.P=q;v.$=s;
v.wa=function(a,b,c){var d="IDB"+this;this.K=a;this.P=b;this.$=!!c;a=this.G;if(b!=q)if(this.G!=q){a=Ee.cmp(b,this.G.lower);if(this.reverse&&1==a){S(this.xa,d+" not opened, index key in reverse out of range "+b+">"+this.G.lower);this.u(l,l,l);return}if(!this.reverse&&-1==a){S(this.xa,d+" not opened, index key out of range "+b+"<"+this.G.lower);this.u(l,l,l);return}a=va.bound(b,this.G.upper,s,this.G.upperOpen)}else a=va.lowerBound(b);b=this.a.objectStore(this.Gb);c=this.c?b.index(this.c):q;S(this.xa,
d+" opening ");b=this.Va?c?this.W!=q?c.openKeyCursor(a,this.W):a!=q?c.openKeyCursor(a):c.openKeyCursor():this.W!=q?b.openCursor(a,this.W):a!=q?b.openCursor(a):b.openCursor():c?this.W!=q?c.openCursor(a,this.W):a!=q?c.openCursor(a):c.openCursor():this.W!=q?b.openCursor(a,this.W):a!=q?b.openCursor(a):b.openCursor();Q(this.xa,d+" opened, request "+b.readyState);b.onsuccess=na(this.xc,this);b.onerror=na(this.V,this)};v.X=function(){return!!this.p};v.Fb=function(){return this.p.key};v.r=function(){return this.p.primaryKey};
v.fb=function(){return this.p.value};v.Hb=function(a){if(this.p){var b=new L;a=this.p.update(a);a.onsuccess=function(a){M(b,a.target.result)};a.onerror=function(a){b.m(a)};return b}k(new Yc("cursor gone"))};v.clear=function(){if(this.p){var a=new L,b=this.p["delete"]();b.onsuccess=function(){M(a,1)};b.onerror=function(b){a.m(b)};return a}k(new Yc("cursor gone"))};v.$a=function(a,b){S(this.xa,this+" restarting.");this.wa(b,a,p)};
v.advance=function(a){this.p||k(new Tc(this+" cursor gone."));this.K=this.P=q;this.$=s;if(1==a)this.p["continue"]();else this.p.advance(a)};v.Aa=function(a){this.p||k(new Tc(this+" cursor gone."));this.f?(this.P=q,this.K=a,this.$=s,this.p["continue"]()):(this.K=this.P=q,this.$=s,this.p["continue"](a))};v.D=function(a){this.p||k(new Tc(this+" cursor gone."));this.K=this.P=q;this.$=s;if(a!=q)this.p["continue"](a);else this.p["continue"]()};v.oa=function(){We.J.oa.call(this);this.p=q};function Xe(a,b,c){fd.call(this,a,b,c)}G(Xe,nd);Xe.prototype.d=V("ydn.db.index.req.IndexedDb");Xe.prototype.e=function(a,b,c,d,e,f){var g=[],h="TX"+b+" keysByIterator:"+d,j=this;S(this.d,h);var n=Sc(d,a,b,this);n.V=function(a){P(j.d,"error:"+h);Rc(d);n.s();c(a,p)};var m=0,r=s;n.u=function(a,b){x(a)?!r&&0<f?(n.advance(f),r=p):(m++,g.push(n.f?b:a),!x(e)||m<e?n.D():(Rc(d),n.s(),S(j.d,"success:"+h),c(g))):(Rc(d),n.s(),S(j.d,"success:"+h),c(g))}};
Xe.prototype.c=function(a,b,c,d,e,f){var g=[],h="TX"+b+" listByIterator"+d,j=this;S(this.d,h);var n=Sc(d,a,b,this);n.V=function(a){Q(j.d,"error:"+h);Rc(d);n.s();c(a,s)};var m=0,r=s;n.u=function(a,b,H){x(b)?!r&&0<f?(n.advance(f),r=p):(m++,g.push(d.Q?a:H),!x(e)||m<e?n.D():(Rc(d),Q(j.d,"success:"+h),n.s(),c(g))):(Rc(d),S(j.d,"success:"+h),n.s(),c(g))}};Xe.prototype.b=function(a,b,c,d,e,f,g){return new We(a,b,c,d,e,f,g)};function Ye(a,b,c,d,e,f,g,h){Ue.call(this,a,b,d,e,f,g,h);this.b=c;this.S=0}G(Ye,Ue);v=Ye.prototype;v.la=V("ydn.db.index.req.WebsqlCursor");v.Da=q;v.S=NaN;v.Fb=t("h");v.r=t("e");v.fb=t("k");
function Ze(a,b){var c=[],d=a.b.c;Qa(d);var e=B(a.c)?Zd(a.b,a.c):q,f=!!e,g=e?e.type:a.b.type,h=e?e.b:d;Qa(h);var j=a.G;e&&a.q!=q?j=a.G!=q?va.bound(a.q,a.G.upper,s,a.G.upperOpen):va.lowerBound(a.q):!e&&a.Da!=q&&(j=a.reverse?va.upperBound(a.Da,s):va.lowerBound(a.Da,s));e=$d(a.b,c,a.Va?ae:be,a.c,j,a.reverse,a.unique);e+=" LIMIT 1";0<a.S&&(e+=" OFFSET "+a.S);a.T=p;S(a.la,a+": move:  SQL: "+e+" : "+J(c));a.a.executeSql(e,c,function(c,e){a.T=s;a.h=l;a.e=l;a.k=l;if(0<e.rows.length){var j=e.rows.item(0);
a.e=Ud(j[d],a.b.type);a.h=f?Ud(j[h],g):a.e;a.k=a.Va?l:Td(j,a.b)}b.call(a,a.e,a.h,a.k);b=q},function(c,d){a.T=s;P(a.la,"get error: "+d.message);a.V(d);a.h=l;a.e=l;a.k=l;b.call(a,a.e,a.h,a.k);b=q;return s})}v.X=function(){return!!this.a&&0<=this.S};
v.Hb=function(a,b){this.X()||k(new Yc);b&&k(new id);var c=new L,d=this;this.T=p;var e=this.r(),f=de(d.b,a,e),g="REPLACE INTO "+ee(this.b)+" ("+f.Mb.join(", ")+") VALUES ("+f.bc.join(", ")+") ON CONFLICT FAIL";S(d.la,this+': clear "'+g+'" : '+J(f.B));this.a.executeSql(g,f.B,function(){d.T=s;M(c,e)},function(a,b){d.T=s;P(d.la,"get error: "+b.message);c.m(b);return s});return c};v.advance=function(a){this.S+=a;Ze(this,this.v)};
v.D=function(a){this.X()||k(new Tc(this+" cursor gone."));a!=q?this.f?this.q=a:this.Da=a:this.S++;Ze(this,this.v)};v.wa=function(a,b,c){this.Da=a;this.q=b;c&&this.S++;Ze(this,this.v)};
v.clear=function(a){this.X()||k(new Yc);a&&k(new id);var b=new L,c=this;this.T=p;a=this.b.c;a="DELETE FROM "+ee(this.b)+" WHERE "+a+" = ?";var d=[this.r()];S(c.la,this+': clear "'+a+'" : '+J(d));this.a.executeSql(a,d,function(a,d){c.T=s;M(b,d.rowsAffected)},function(a,d){c.T=s;P(c.la,"get error: "+d.message);b.m(d);return s});return b};v.$a=function(a,b){S(this.la,this+" restarting.");this.S=0;this.wa(b,a,s)};
v.Aa=function(a){this.X()||k(new Tc(this+" cursor gone."));if(this.e!=q){var b=za(a,this.e);(0==b||1==b&&this.reverse||-1==b&&!this.reverse)&&k(new Tc(this+' to continuePrimaryKey for "'+a+'" on '+this.W+" direction is wrong"));this.S++;Ze(this,function(b,d,e){if(b!=q){var f=za(a,b);0==f||1==f&&this.reverse||-1==f&&!this.reverse?this.v(b,d,e):this.Aa(a)}else this.v(l,l,l)})}else this.v(l,l,l)};V("ydn.db.index.req.CachedWebsqlCursor");function $e(a,b,c){fd.call(this,a,b,c)}G($e,Sd);$e.prototype.d=V("ydn.db.index.req.WebSql");$e.prototype.e=function(a,b,c,d,e,f){af(this,a,b,c,d,p,e,f)};$e.prototype.c=function(a,b,c,d,e,f){af(this,a,b,c,d,s,e,f)};
function af(a,b,c,d,e,f,g,h){var j=[],n="TX"+c+(f?" keys":" values")+"ByIterator "+e;S(a.d,n);var m=Sc(e,b,c,a);m.V=function(b){P(a.d,"error:"+n);Rc(e);m.s();d(b,p)};var r=0,u=s;m.u=function(b,c,C){x(b)?!u&&0<h?(m.advance(h),u=p):(r++,j.push(f?m.f?c:b:e.Q?b:C),!x(g)||r<g?m.D():(Rc(e),m.s(),S(a.d,"success:"+n),d(j))):(Rc(e),m.s(),S(a.d,"success:"+n),d(j))}}$e.prototype.b=function(a,b,c,d,e,f,g){var h=X(this.a,c);return new Ye(a,b,h,c,d,e,f,g)};function bf(a,b,c){fd.call(this,a,b,c)}G(bf,Od);function cf(a,b,c,d){Ie.call(this,a,b,c,d)}G(cf,Je);v=cf.prototype;v.i=V("ydn.db.index.DbOperator");v.ua=function(a,b){var c=this;if(a instanceof W){var d=vb(),e=a.R,f=X(this.b,e);f||k(new K('store "'+e+'" not found.'));var g=a.Ba();x(g)&&!ve(f,g)&&k(new K('index "'+g+'" not found in store "'+e+'".'));f=new L;f.C(function(a){M(d,a[0])},function(a){d.m(a)});Q(this.i,"listByIterator:"+a);this.a.j(f,function(b,d,e){Y(c).c(b,d,e,a,1,0)},[e],N,"getByIterator");return d}return cf.J.ua.call(this,a,b)};
v.keys=function(a,b,c,d,e){var f=this;if(a instanceof W){d=vb();var g=100;D(b)?(g=b,1>g&&k(new K("limit must be a positive value, but "+b))):x(b)&&k(new K("limit must be a number,  but "+b));var h=0;D(c)?h=c:x(c)&&k(new K("offset must be a number,  but "+c));Q(this.i,"keysByIterator:"+a);this.a.j(d,function(b,c,d){Y(f).e(b,c,d,a,g,h)},a.stores(),N,"listByIterator");return d}return cf.J.keys.call(this,a,b,c,d,e)};
v.ta=function(a,b,c){var d=this;return a instanceof W?((x(b)||x(c))&&k(new K("too many arguments.")),b=vb(),Q(this.i,"countKeyRange:"+a),this.a.j(b,function(b,c,g){Y(d).ma(b,c,g,a.R,a.L,a.Ba(),a.dc())},a.stores(),N,"countByIterator"),b):cf.J.ta.call(this,a,b,c)};
v.B=function(a,b,c,d,e){var f=this;if(a instanceof W){d=vb();var g;D(b)?(g=b,1>g&&k(new K("limit must be a positive value, but "+g))):x(b)&&k(new K("limit must be a number, but "+b));var h;D(c)?h=c:x(c)&&k(new K("offset must be a number, but "+c));Q(this.i,"listByIterator:"+a);this.a.j(d,function(b,c,d){Y(f).c(b,c,d,a,g,h)},a.stores(),N,"listByIterator");return d}return cf.J.B.call(this,a,b,c,d,e)};
v.jc=function(a,b,c){var d=vb();y(a)||k(new TypeError("First argument must be array."));for(var e=0;e<a.length;e++){var f=a[e]instanceof Re;!(a[e]instanceof W)&&!f&&k(new TypeError("Iterator at "+e+" must be cursor range iterator or streamer."))}f=[];for(e=0;e<a.length;e++)for(var g=a[e].stores(),h=0;h<g.length;h++)0<=xa(f,g[h])||f.push(g[h]);S(this.i,this+": scan for "+a.length+" iterators on "+f);for(var j=c||[],e=0;e<j.length;e++)c=j[e].a,0<=xa(f,c)||f.push(c);var n=this;this.a.j(d,function(c,
d,e){function f(){for(var b=0,e=0;e<a.length;e++){var j=a[e],u=Sc(j,c,d,Y(n));u.V=g;u.u=oa(h,b);la[e]=u;Ka[b]=e;b++;for(var u=0,z=j.Za.length+1-1;u<z;u++){var Vd;Y(n);Vd=new Re(c,j.Za[u],j.oc[u]);Vd.ac(oa(T,b));qb.push(Vd);Va[b]=qb.length;b++}}ja=a.length+qb.length}function g(b){for(var c=0;c<a.length;c++)Rc(a[c]);for(c=0;c<la.length;c++)la[c].s();bb(la);bb(qb);Q(n.i,n+":tx"+d+": scanning error.");e(b,p)}function h(b,c,d,e){U&&k(new jd);Wa++;var f=a[Ka[b]];fb[b]=f.c?d:c;pb[b]=f.Q?c:e;b=Va[b];c=0;
for(f=f.Za.length+1-1;c<f;c++){var g=qb[b+c],j=d,n=e;x(g.b)?g.push(n):g.push(j)}Wa===ja&&R()}function T(a,b,c){U&&k(new jd);fb[a]=b;pb[a]=c;Wa++;Wa===ja&&R();return s}function R(){var c;c=b instanceof Ve?b.c(fb,pb):b(fb,pb);var f=[],g=[],h=[],j=[];if(y(c))for(var m=0;m<c.length;m++)c[m]===p?h[m]=1:c[m]===s?j[m]=p:g[m]=c[m];else if(c===q)f=[];else if(x(c))E(c)?(f=c.continuePrimary||[],g=c["continue"]||[],h=c.advance||[],j=c.restart||[]):k(new ld("scan callback output"));else{f=[];for(m=0;m<a.length;m++)x(Ka[m])&&
(h[m]=1)}for(m=Wa=c=0;m<a.length;m++)f[m]==q&&(g[m]==q&&j[m]==q&&h[m]==q)&&Wa++;for(m=0;m<a.length;m++)if(f[m]!=q||g[m]!=q||j[m]!=q||h[m]!=q){var z=Ka[m];x(z)||k(new ld(m+" is not an iterator."));var z=a[z],C=la[m];fb[m]==q&&(h[m]===p||g[m]!=q||f[m]!=q)&&k(new Tc(z+" at "+m+" must not advance."));fb[m]=l;pb[m]=l;j[m]!=q?C.$a():g[m]!=q?C.D(g[m]):f[m]!=q?C.Aa(f[m]):h[m]!=q?C.advance(1):k(new jd(z+": has no action"));c++}if(0==c){for(f=0;f<a.length;f++)Rc(a[f]);for(f=0;f<la.length;f++)la[f].s();U=p;
bb(la);bb(qb);Q(n.i,n+":tx"+d+": scanning success.");e(l)}}S(n.i,n+":tx"+d+": scanning started.");for(var U=s,ja,Va=[],Ka=[],fb=[],pb=[],la=[],qb=[],Wa=0,Bb=0;Bb<j.length;Bb++)Se(j[Bb],c);b instanceof Ve?b.b(a,function(){f()})||f():f()},f,N,"join");return d};
v.ic=function(a,b,c){a instanceof W||k(new K("First argument must be cursor range iterator."));X(this.b,a.R)||k(new K('Store "'+a.R+'" not found.'));c=c||N;var d=this,e=vb();Q(this.i,"open:"+c+" "+a);this.a.j(e,function(c,e,h){var j=Sc(a,c,e,Y(d));j.V=function(b){Rc(a);j.s();h(b,p)};j.u=function(c){c!=q?(c=b(j),c===p?j.$a(q,q):E(c)?c.restart===p?j.$a(c["continue"],c.continuePrimary):c["continue"]!=q?j.D(c["continue"]):c.continuePrimary!=q?j.Aa(c.continuePrimary):(Rc(a),j.s(),h(l)):j.advance(1)):(Rc(a),
j.s(),h(l))}},a.stores(),c,"open");return e};v.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)e||k(new K('Store "'+e+'" not found.'));e=vb();S(this.i,"map:"+a);this.a.j(e,function(d,e,f){var n=Sc(a,d,e,Y(c));n.V=function(a){f(a,s)};n.u=function(c,d,e){c!=q?(b(a.Q?a.c?d:c:a.c?c:e),n.advance(1)):(f(l),b=q)}},d,N,"map");return e};
v.reduce=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)f||k(new K('Store "'+f+'" not found.'));f=vb();var h=E(c)?ta(J(c)):c;Q(this.i,"reduce:"+a);this.a.j(f,function(c,e,f){var g=Sc(a,c,e,Y(d));g.V=function(a){f(a,p)};var u=0;g.u=function(c,d,e){c!=q?(h=b(h,a.Q?a.c?d:c:a.c?c:e,u++),g.advance(1)):f(h)}},e,N,"map");return f};function se(a,b){var c;c=c||{};if(a==q||b==q)return s;if(y(a)&&y(b)){if(a.length!=b.length)return s;for(var d=0;d<a.length;d++)if(-1==$a(b,function(b){return se(b,a[d])}))return s;return p}if(y(a))return 1==a.length&&se(a[0],b);if(y(b))return 1==b.length&&se(b[0],a);if(E(a)&&E(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=se(a[e],b[e]);if(!f)return s}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=se(a[e],b[e]),!f))return s;return p}return a===b}
function he(a){for(var b in a)if(a.hasOwnProperty(b))return a[b]};function df(a){this.a=a}df.prototype.a=[];
df.prototype.b=function(a,b){for(var c=[],d=0;d<this.a.length;d++){var e=this.a[d],f="'"===e[0]&&"'"===e[e.length-1];if('"'===e[0]&&'"'===e[e.length-1])e=Pb(a,Na(e,'"').split(".")),c.push(e);else if(f)c.push(Na(e,"'"));else if(B(e))if("true"===e)c.push(p);else if("false"===e)c.push(s);else if("Date"===e)c.push(new Date(parseInt(c.pop(),10)));else if("now"===e)c.push(new Date);else if("!"===e)c[c.length-1]=!c[c.length-1];else if("=="===e)c.push(c.pop()==c.pop());else if("==="===e)c.push(c.pop()===
c.pop());else if("!="===e)c.push(c.pop()!=c.pop());else if("!=="===e)c.push(c.pop()!==c.pop());else if("<="===e)c.push(c.pop()<=c.pop());else if("<"===e)c.push(c.pop()<c.pop());else if(">="===e)c.push(c.pop()>=c.pop());else if(">"===e)c.push(c.pop()>c.pop());else if("&"===e)c.push(c.pop()&c.pop());else if("|"===e)c.push(c.pop()|c.pop());else if("?"===e){var e=!!c.pop(),f=c.pop(),g=c.pop(),e=e?f:g;c.push(e)}else"+"===e?c.push(c.pop()+c.pop()):"-"===e?c.push(c.pop()-c.pop()):"*"===e?c.push(c.pop()*
c.pop()):"/"===e?c.push(c.pop()/c.pop()):"%"===e?c.push(c.pop()%c.pop()):"at"===e?(f=c.pop(),e=c.pop(),c.push(e[f])):"of"===e?(f=c.pop(),e=c.pop(),e=y(e)?e.indexOf(f):-1,c.push(e)):"in"===e?(f=c.pop(),e=c.pop(),e=y(e)?0<=e.indexOf(f):s,c.push(e)):"abs"===e?c[c.length-1]=Math.abs(c[c.length-1]):"$"==e[0]&&/^\$\d$/.test(e)?(e=parseInt(e.match(/^\$(\d)$/)[1],10),c.push(arguments[e])):c.push(parseFloat(e));else c.push(e)}return c[0]};
df.prototype.c=function(){return function(){var a=2<arguments.length?Array.prototype.slice(arguments,2):l;return df.prototype.b.apply(q,a)}};df.prototype.toJSON=function(){return{Tokens:ta(J(this.a))}};function ef(a){B(a)||k(new gd);this.O=a;ff(this,a);this.Ka=""}v=ef.prototype;v.O="";v.La=N;v.Vb=NaN;v.Xb=NaN;v.zb=s;v.Ka="";
function ff(a,b){var c=b.split(/\sFROM\s/i);2!=c.length&&k(new cd("FROM required."));var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);3!=c.length&&k(new cd("Unable to parse: "+b));a.c=c[1].toUpperCase();"SELECT"==a.c?a.La=N:"INSERT"==a.c?a.La=O:"UPDATE"==a.c?a.La=O:"DELETE"==a.c?a.La=O:k(new cd("Unknown SQL verb: "+a.c));var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.e=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.e=l;"("==c.charAt(0)&&
(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-1):new cd("missing closing parentheses"));a.q=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.a=d.substring(c),d=d.substring(0,c)):a.a="";c=d.search(/WHERE/i);0<c?(a.f=d.substring(c+6).trim(),d=d.substring(0,c)):a.f="";a.b=d.trim().split(",").map(function(a){a=Na(a,'"');a=Na(a,"'");return a.trim()})}
v.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.O=this.O.replace("?",a[b]);ff(this,this.O)}this.h=gf(this);if(!this.h)return this.Ka;a=this.a.length;if(b=/OFFSET\s+(\d+)/i.exec(this.a))this.Xb=parseInt(b[1],10),a=this.a.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.a))this.Vb=parseInt(b[1],10),b=this.a.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.a.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.zb="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.zb=s,this.k=Na(Na(a,'"'),"'")):this.k=l;return""};function hf(a){if("*"==a.q)return q;a=a.q.split(",");return a=a.map(function(a){return Na(a.trim(),'"')})}v.toJSON=function(){return{sql:this.O}};
function gf(a){function b(a){return ab(c,function(b){return b.aa==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.f.length)for(var e=a.f.split("AND"),f=0;f<e.length;f++){var g=e[f],h=d.exec(g);if(h){var j=h[1].trim(),j=Na(j,'"'),j=Na(j,"'");if(0<j.length){var n=h[3].trim(),n=Ca(n,'"')?Na(n,'"'):Ca(n,"'")?Na(n,"'"):parseFloat(n),h=new Nb(j,h[2],n),j=b(j);if(0<=j){if(c[j]=c[j].lb(h),!c[j])return a.Ka='where clause "'+g+'" conflict',q}else c.push(h)}else return a.Ka='Invalid clause "'+g+'"',q}else return a.Ka=
'Invalid clause "'+g+'"',q}return c}v.toString=function(){return"query:"+this.O};function jf(a,b){this.sql=b;this.a=a}jf.prototype.toJSON=function(){return{sql:this.sql}};jf.prototype.toString=ba("idb.Node:");
jf.prototype.lc=function(a,b,c,d){var e=db(this.sql.b)[0],f=this.sql.h,g=this.sql.Vb,g=isNaN(g)?100:g,h=this.sql.Xb,h=isNaN(h)?0:h,j=this.sql.k,n=hf(this.sql),m=q,r=this.sql.zb;0==f.length?m=q:1==f.length?m=ua(f[0].a):k(new hd("too many conditions."));var u=c;n===q||(u=function(a,b){if(b)c(a,p);else{var d=a.map(function(a){var b=n.length;if(1==b)return Ab(a,n[0]);for(var c={},d=0;d<b;d++)c[n[d]]=Ab(a,n[d]);return c});c(d)}});j&&j!=this.a.keyPath?d.Ga(a,b,u,e,j,m,r,g,h,s):0<f.length&&f[0].aa!=this.a.keyPath?
d.Ga(a,b,u,e,f[0].aa,m,r,g,h,s):d.Ha(a,b,u,e,m,r,g,h)};function kf(a,b){jf.call(this,a,b)}G(kf,jf);
kf.prototype.lc=function(a,b,c,d){var e,f=db(this.sql.b)[0],g=this.sql.h,h=q;0==g.length?h=q:1==g.length?h=ua(g[0].a):k(new hd("too many conditions."));var j=this.sql.e;if("COUNT"==j)h?d.ma(a,b,c,f,h,g[0].aa,s):d.ma(a,b,c,f,q,l,s);else{var n,m=hf(this.sql);(!m||0==m.length)&&k(new Tc("field name require for reduce operation: "+j));var r=m[0];"MIN"==j?n=function(a,b){var c=a[r];return!x(b)?c:b<c?b:c}:"MAX"==j?n=function(a,b){var c=a[r];return!x(b)?c:b>c?b:c}:"AVG"==j?(e=0,n=function(a,b,c){x(b)||(b=
0);return(b*c+a[r])/(c+1)}):"SUM"==j?(e=0,n=function(a,b){return b+a[r]}):k(new hd(j));var u=Sc(h?new Pc(f,g[0].aa,h):new Oc(f),a,b,d);u.V=function(a){c(a,p)};var z=0;u.u=function(a,b,d){x(b)?(e=n(d,e,z),u.advance(1),z++):c(e)}}};function lf(a,b,c){fd.call(this,a,b,c)}G(lf,Xe);lf.prototype.d=V("ydn.db.sql.req.IndexedDb");lf.prototype.executeSql=function(a,b,c,d,e){(e=d.parse(e))&&k(new cd(e));e=db(d.b);if(1==e.length){var f=X(this.a,e[0]);f||k(new Zc(e[0]));var g=hf(d);if(g)for(var h=0;h<g.length;h++)ve(f,g[h])||k(new Zc('Index "'+g[h]+'" not found in '+e[0]));(d.e?new kf(f,d):new jf(f,d)).lc(a,b,c,this)}else k(new hd(d.O))};function mf(a,b){this.sql=b;this.c=a;this.a=hf(b)}mf.prototype.b=V("ydn.db.sql.req.websql.Node");mf.prototype.toJSON=function(){return{sql:this.sql.O}};mf.prototype.toString=ba("websql.Node:");function nf(a,b){if(a.a){if(1==a.a.length){if(E(b))return Pb(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=Pb(b,a.a[d]);return c}return Td(b,a.c)}
mf.prototype.mc=function(a,b,c){var d=this,e=[];b.executeSql(this.sql.O,c,function(b,c){for(var h=c.rows.length,j=0;j<h;j++){var n=c.rows.item(j);if(E(n))var m=nf(d,n);e.push(m)}a(e)},function(b,c){P(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function of(a,b){mf.call(this,a,b)}G(of,mf);of.prototype.mc=function(a,b,c){var d=this;b.executeSql(this.sql.O,c,function(b,c){var d=c.rows.length;1==d?(d=he(c.rows.item(0)),a(d)):0==d?a(l):k(new Wc)},function(b,c){P(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function pf(a,b,c){fd.call(this,a,b,c)}G(pf,$e);pf.prototype.d=V("ydn.db.sql.req.WebSql");pf.prototype.executeSql=function(a,b,c,d,e){b=db(d.b);if(1==b.length){var f=X(this.a,b[0]);f||k(new Zc(b[0]));var g=hf(d);if(g)for(var h=0;h<g.length;h++)ve(f,g[h])||k(new Zc('Index "'+g[h]+'" not found in '+b[0]));(d.e?new of(f,d):new mf(f,d)).mc(c,a,e)}else k(new hd(d.O))};function qf(a,b,c){fd.call(this,a,b,c)}G(qf,bf);function rf(a,b,c,d){Ie.call(this,a,b,c,d)}G(rf,cf);rf.prototype.executeSql=function(a,b){for(var c=vb(),d=new ef(a),e=db(d.b),f=0;f<e.length;f++){var g=X(this.b,e[f]);g||k(new K("store: "+g+" not exists."))}var h=this;Q(this.i,"executeSql: "+a+" params: "+b);this.a.j(c,function(a,c,e){Y(h).executeSql(a,c,e,d,b||[])},db(d.b),d.La,"executeSql");return c};function sf(){this.clear()}v=sf.prototype;v.setItem=function(a,b){x(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};v.getItem=function(a){return this.a[a]||q};v.removeItem=function(a){delete this.a[a];cb(this.keys,a.toString());this.length=this.keys.length};v.length=0;v.key=function(a){a=this.keys[a];return x(a)?this.a[a]:q};v.clear=function(){this.a={};this.keys=[];this.length=0};function tf(a){this.g=a||new sf}v=tf.prototype;v.fc=V("ydn.db.con.SimpleStorage");v.Db=ba(1);v.ra=function(a,b){this.na=a;this.c=b;this.a={};for(var c=0;c<b.stores.length;c++){var d=b.c(c);this.a[d.getName()]=d.toJSON()}this.indexes={};d=uf(this);if(c=ta(this.g.getItem(d)))for(var e in c)c.hasOwnProperty(e)&&!Ae(b,e)&&(d=c[e],b.a()?(Q(this.fc,"Adding existing store: "+e),this.a[e]=d):(Q(this.fc,"Deleting old store: "+e),Rd(this,e)));else this.g.setItem(d,J(this.a));return tb(1)};v.bb=function(){return!!this.na};
v.Cb=function(){return this.g||q};v.sa=ba("memory");v.ab=aa();v.Qa=function(a,b,c,d){a(this);d("complete",{})};v.ba=function(a){Nd(function(){for(var b=[],c=this.g.getItem(uf(this)).stores,d=0;d<c.length;d++){var e=this.g.getItem(uf(this,c[d]));b[d]=new te(c[d],e.keyPath,e.autoIncrement)}b=new ye(this.na,b);a(b)},0,this)};function uf(a,b,c){a=["ydn.db",a.na];x(b)&&(a.push(b),x(c)&&a.push(Db(c)));return a.join("^|")}
function Qd(a,b,c){b=uf(a,b instanceof te?b.name:b,c);a=a.g.getItem(b);return a=a===q?l:ta(a)}function Pd(a,b,c,d){var e;e=X(a.c,c);d=x(d)?d:e.keyPath!=q?we(e,b):l;x(d)||(e.autoIncrement?(uf(a,e.name),d=a.a[e.name],x(d.autoIncrementNo)||(d.autoIncrementNo=a.Ta(e.name,q).length),d.autoIncrementNo++,d=d.autoIncrementNo):k(new Vc));e=d;d=uf(a,c,e);b=J(b);a.g.setItem(d,b);if(a=a.a[c].Keys){c=0;for(b=a.length;c<b&&e!=a[c];c++)if(e>a[c]){eb(a,c,0,e);break}}return e}
function Rd(a,b,c){if(x(c))a.g.removeItem(uf(a,b,c)),a=a.a[b].Keys,x(a)&&cb(a,c);else if(x(b)){a.a[b]&&(a.a[b].Keys=q);c=uf(a,b)+"^|";for(b=a.g.length-1;0<=b;b--){var d=a.g.key(b);Ca(d,c)&&a.g.removeItem(d)}}else{c=uf(a)+"^|";for(b=a.g.length-1;0<=b;b--)d=a.g.key(b),Ca(d,c)&&a.g.removeItem(d)}}
v.index=function(a){var b=this.a[a],c=b.Keys;if(c==q){c=[];a=uf(this,a);a+="^|";for(var d=0,e=this.g.length;d<e;d++){var f=this.g.key(d);if(Ca(f,a)){c.push(f);for(var f=0,g=b.indexes.length;f<g;f++);}}Ua.sort.call(c,jb);b.Keys=c;b.indexes={}}return c};
v.Ta=function(a,b,c,d,e,f){function g(){return e?function(a){return a>c}:function(a){return a>=c}}function h(){return f?function(a){return a<=d}:function(a){return a<d}}b!=q&&k(new id);a=this.index(a);if(!x(c)&&!x(d))return a;if(x(c)){if(x(d)){b=ab(a,h());var j=ab(a,g());return a.slice(b,j)}b=ab(a,g());return a.slice(b)}b=ab(a,h());return a.slice(0,b)};function vf(){tf.call(this,window.localStorage)}G(vf,tf);vf.prototype.sa=ba("localstorage");function wf(){tf.call(this,window.sessionStorage)}G(wf,tf);wf.prototype.sa=ba("sessionstorage");var Me="created",Pe="deleted",Oe="updated";function xf(a,b){ud.call(this,a,b)}G(xf,ud);xf.prototype.h=t("e");function yf(a,b,c,d,e){ud.call(this,a,b);this.version=c;this.hc=d;this.gc=e}G(yf,xf);v=yf.prototype;v.name="StorageEvent";v.version=NaN;v.hc=NaN;v.gc=q;v.Nc=t("version");v.tc=t("hc");v.Mc=t("gc");function Ne(a,b,c,d,e){ud.call(this,a,b);this.e=c;this.key=d;this.value=e}G(Ne,xf);Ne.prototype.name="RecordEvent";Ne.prototype.f=t("key");Ne.prototype.k=t("value");
function Le(a,b,c,d,e){ud.call(this,a,b);this.e=c;this.keys=d;this.B=e}G(Le,xf);Le.prototype.name="StoreEvent";Le.prototype.Ta=t("keys");Le.prototype.f=t("B");function He(a,b){ye.call(this,a,b)}G(He,ye);He.prototype.a=ba(p);/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
*/
function Z(a,b,c){pd.call(this);c=c||{};var d=["autoSchema","connectionTimeout","size","mechanisms","thread"],e;for(e in c)c.hasOwnProperty(e)&&-1==xa(d,e)&&k(new K('Unknown attribute "'+e+'" in options.'));this.uc=c.mechanisms||zf;this.Ya=c.size;this.vc=x(c.connectionTimeout)?c.connectionTimeout:3E4;this.cc=x(c.cc)?c.cc:s;this.a=q;this.h=[];this.Ua=s;if(b instanceof ye)e=b;else if(E(b)){e=c.autoSchema||!x(b.stores)?new He(b):new ye(b);c=0;for(d=b.stores?b.stores.length:0;c<d;c++){var f=X(e,b.stores[c].name);
b.stores[c].Sync&&P(this.f,"Synchronization option for "+f.getName()+" ignored.")}}else e=new He;this.b=e;x(a)&&this.q(a)}G(Z,Ld);Z.prototype.f=V("ydn.db.con.Storage");Z.prototype.wc=function(a){if(x(a)){var b=function(b){a(b.toJSON())};if(this.a)this.a.ba(b);else{var c=this;this.transaction(function(a){c.a.ba(b,a)},q,N)}}return this.b?this.b.toJSON():q};
function Ke(a,b){var c=b instanceof te?b:ue(b),d=b.name,e=X(a.b,d);0==xe(c,e).length?tb(s):(e=e?"update":"add",a.b instanceof He?(a.b.stores.push(c),a.a?(a.a.ab(),a.a=q,Af(a)):tb(s)):k(new kd("Cannot "+e+" store: "+d+". Not auto schema generation mode.")))}Z.prototype.q=function(a){this.a&&k(Error("Already defined with "+this.e));this.e=a;Af(this)};F("ydn.db.con.Storage.prototype.setName",Z.prototype.q);Z.prototype.getName=t("e");var zf=["indexeddb","websql","localstorage","sessionstorage","memory"];
function Bf(a,b){return"indexeddb"==b?new Ce(a.Ya,a.vc):"websql"==b?new Fe(a.Ya):"localstorage"==b?new vf:"sessionstorage"==b?new wf:"memory"==b?new tf:q}
function Af(a){function b(b,d){b?(S(a.f,a+": ready."),a.Lc=NaN,Nd(function(){a.onReady(d);Cf(a)}),M(c,d)):(P(a.f,a+": database connection fail "+d.name),Nd(function(){a.onReady(d);if(a.h){a.f.log(yc,"Purging "+a.h.length+" transactions request.",l);for(var b;b=a.h.shift();)b.H&&b.H("error",d)}}),c.m(d))}for(var c=new L,d=q,e=a.uc,f=0;f<e.length;f++){var g=e[f].toLowerCase();if("indexeddb"==g&&Ee){d=Bf(a,g);break}else if("websql"==g&&fa(w.openDatabase)){d=Bf(a,g);break}else if("localstorage"==g&&window.localStorage){d=
Bf(a,g);break}else if("sessionstorage"==g&&window.sessionStorage){d=Bf(a,g);break}else if("memory"==g){d=Bf(a,g);break}}d===q&&(e=new kd("No storage mechanism found."),b(s,new yf("ready",a,NaN,NaN,e)));d.ra(a.e,a.b).C(function(c){a.a=d;b(p,new yf("ready",a,parseFloat(d.Db()),parseFloat(c),q));d.b=function(){S(a.f,a+": disconnected.")}},function(c){P(a.f,a+": opening fail: "+c.message);var d=new yf("ready",a,NaN,NaN,c);d.message=c.message;b(s,d)})}Z.prototype.k=function(){if(this.a)return this.a.sa()};
F("ydn.db.con.Storage.prototype.getType",Z.prototype.k);Z.prototype.onReady=function(a){Md(this,a)};Z.prototype.Wa=function(){this.a&&(this.a.ab(),this.a=q,S(this.f,this+" closed"))};F("ydn.db.con.Storage.prototype.close",Z.prototype.Wa);v=Z.prototype;v.Kc=function(){return this.a?this.a.Cb():q};v.Lc=NaN;function Cf(a){var b=a.h.shift();b&&(S(a.f,"pop tx queue "+b.ia.name),a.transaction(b.ia,b.Ac,b.mode,b.H));pa()}v.Ua=s;
v.transaction=function(a,b,c,d){var e=b;if(B(b))e=[b];else if(b!=q)if(A(b)){0==b.length&&k(new K("number of store names must more than 0"));for(var f=0;f<b.length;f++)B(b[f])||k(new K("store name at "+f+" must be string but found "+typeof b[f]))}else k(new K("store names must be an array"));else e=q;if(!this.a||!this.a.bb()||this.Ua)b=a,f=d,S(this.f,"push tx queue "+b.name),this.h.push({ia:b,Ac:e,mode:c,H:f}),pa(),100<this.h.length&&0==this.h.length%100&&P(this.f,"Transaction queue stack size is "+
this.h.length+". It is too large, possibility due to incorrect usage.");else{var g=this,h=x(c)?c:N;h==yb&&(this.Ua=p);this.a.Qa(function(b){a(b);a=q},e,h,function(a,b){fa(d)&&(d(a,b),d=l);h==yb&&(g.Ua=s);Cf(g)})}};v.addEventListener=function(a,b,c,d){function e(a){0<=xa(["created","ready","deleted","updated"],a)||k(new K('Invalid event type "'+a+'"'))}if(A(a))for(var f=0;f<a.length;f++)e(a[f]);else e(a);Z.J.addEventListener.call(this,a,b,c,d)};v.toString=function(){return"ydn.db.con.Storage:"+this.a};function le(a){this.e=a;this.a=q;this.b=0}v=le.prototype;v.Qc=V("ydn.db.tr.Mutex");v.gb="";v.I=q;function Df(a,b,c){if(!a.I||!a.mode||c!=a.mode||a.I.length!=b.length)return s;for(c=0;c<b.length;c++)if(-1==a.I.indexOf(b[c]))return s;return p}v.H=q;v.toString=function(){var a;return a="Mutex:"+this.e+":"+this.b+(this.gb?"["+this.gb+"]":"")};function Ef(a,b,c,d){this.a=a;this.f=b;this.b=db(c);this.c=d;this.e=[]}Ef.prototype.a=q;Ef.prototype.abort=function(){this.a?this.a.abort():k(new Xc("transaction completed"))};Ef.prototype.t=t("f");function Ff(a,b,c){a.a?(b(a.a),c&&a.e.push(c)):k(new Mb("tx committed on ParallelTxExecutor"))}Ef.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.f+" mode:"+this.c+" scopes:"+J(this.b)};function Gf(a,b,c){this.g=a;this.e=b;this.b=0;this.ya=this.N=q;this.c=c||""}v=Gf.prototype;v.N=q;v.ya=q;v.hb=V("ydn.db.tr.Parallel");v.t=t("b");v.type=function(){return this.g.k()};v.abort=function(){Q(this.hb,this+": aborting");je(this.ya)};v.ib=ba(s);
v.pa=function(a,b,c,d){function e(c){h.b++;j=new Ef(c,h.b,b,g);S(h.hb,h+":tx"+j.t()+J(b)+g+" begin");h.N=j;Ff(h.N,a,d)}function f(a,b){S(h.hb,h+":tx"+j.t()+" committed");for(var c=j,d;d=c.e.shift();)d(a,b);c.a=q;c.b=q;c.e=q}var g=x(c)?c:N,h=this,j;this.N&&this.N.a&&this.ib(b,g)?Ff(this.N,a,d):this.g.transaction(e,b,g,f)};v.j=function(a,b,c,d,e,f){var g=this;this.pa(function(c){function d(b,e){g.ya=c;e?a.m(b):M(a,b);d=g.ya=q}b(c,g.t(),d)},c,d,f)};
v.toString=function(){var a;a="Parallel:"+this.g.getName();var b=this.c;return a+":"+this.e+":"+this.t()+(b?" :"+b:"")};function Hf(a,b,c){Gf.call(this,a,b,c)}G(Hf,Gf);Hf.prototype.ib=ba(s);Hf.prototype.j=function(a,b,c,d,e,f){var g,h,j=new L;j.C(function(a){h=s;g=a},function(a){h=p;g=a});Hf.J.j.call(this,j,b,c,d,e,function(b,c){if(h===p)a.m(g);else if(h===s)M(a,g);else{var d=new dd;a.m(d)}f&&(f(b,c),f=l)})};function If(a,b){ke.call(this,a,b)}G(If,ke);If.prototype.c=V("ydn.db.tr.StrictOverflowSerial");If.prototype.Ib=function(a,b){return Df(this.a,a,b)};If.prototype.Sb=function(){var a=this.a;return!!a&&Df(a,0<this.b.length?this.b[0].I:q,0<this.b.length?this.b[0].mode:q)};function Jf(a,b,c){Gf.call(this,a,b,c)}G(Jf,Gf);Jf.prototype.ib=function(a,b){var c;a:if(c=this.N,!c.I||!c.c||b!=c.c||c.b.length!=a.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.b.indexOf(a[d])){c=s;break a}c=p}return c};function Kf(a,b){ke.call(this,a,b)}G(Kf,ke);Kf.prototype.Ib=function(a,b){var c;a:if(c=this.a,!c.I||!c.mode||b!=c.mode&&(c.mode!=O||b!=N)||a.length>c.I.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.I.indexOf(a[d])){c=s;break a}c=p}return c};function Lf(a,b,c){Gf.call(this,a,b,c)}G(Lf,Gf);Lf.prototype.ib=function(a,b){var c;a:if(c=this.N,!c.b||!c.c||b!=c.c&&(c.c!=O||b!=N)||a.length>c.b.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.b.indexOf(a[d])){c=s;break a}c=p}return c};function Mf(a,b,c){Gf.call(this,a,b,c);this.a=s}G(Mf,Gf);Mf.prototype.a=s;Mf.prototype.j=function(a,b,c,d,e,f){function g(c){function d(b,e){h.ya=c;e?a.m(b):M(a,b);d=h.ya=q}b(c,h.t(),d);b=q}var h=this;this.N&&this.N.a?Ff(this.N,g,f):(this.a&&(Gc(this.hb,"single thread has already committed the transaction"),k(new Xc)),this.a=p,this.pa(g,c,d,f))};function Nf(a,b,c){Z.call(this,a,b,c);this.w=0;a="serial";c&&c.thread&&(a=ie.indexOf(c.thread),-1==a&&k(new gd("thread: "+c.thread)),a=ie[a]);this.U=a;this.c=this.Jb(this.U,"base")}G(Nf,Z);v=Nf.prototype;v.w=0;v.Jb=function(a,b){this.w++;b=b||"branch"+this.w;var c=Of(this,a,b);return this.Ia(c,q,b)};v.t=function(){return this.c?this.c.t():NaN};v.Ia=function(a,b,c){return new Ie(this,this.b,c||"",a)};
function Of(a,b,c){b=b||a.U;if("serial"==b)return new ke(a,a.w++);if("parallel"==b)return new Gf(a,a.w++,c);if("atomic-parallel"==b)return new Hf(a,a.w++,c);if("atomic-serial"==b)return new me(a,a.w++);if("samescope-multirequest-parallel"==b)return new Jf(a,a.w++,c);if("samescope-multirequest-serial"==b)return new If(a,a.w++);if("multirequest-parallel"==b)return new Lf(a,a.w++,c);if("multirequest-serial"==b)return new Kf(a,a.w++);if("single"==b)return new Mf(a,a.w++,c);k(new K('invalid transaction policy thread type "'+
b+'"'))}v.abort=function(){return this.c.abort()};
v.zc=function(a,b,c,d,e){var f=this;this.w++;var g=B(a.name)&&0<a.name.length?a.name:"run"+this.w,h=Of(this,"single",g),j=this.Ia(h,q,g),n=c||N;-1==[N,O].indexOf(n)&&k(new K("invalid mode"));b!=q||(b=ze(this.b));if(A(b)){0==b.length&&k(new K("number of store names must more than 0"));for(var m=0;m<b.length;m++)B(b[m])||k(new K("store name at "+m+" must be string but found "+typeof b[m]))}else k(new K("store names must be an array"));var r=a;if(4<arguments.length)var u=Array.prototype.slice.call(arguments,
4),r=function(){var b=Array.prototype.slice.call(arguments),b=b.concat(u);return a.apply(this,b)};S(this.f,"scheduling run in transaction "+g+" with "+h);h.pa(function(){S(f.f,"executing run in transaction "+g);r(j);r=q},b,n,d)};function $(a,b,c){Nf.call(this,a,b,c)}G($,Nf);v=$.prototype;v.Ia=function(a,b,c){return new Je(this,this.b,c||"",a)};v.ub=function(a){var b=this.k();if("indexeddb"==b)return new nd(this.e,this.b,a);if("websql"==b)return new Sd(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new Od(this.e,this.b,a);k(new Wc("No executor for "+b))};v.cb=function(a,b,c){return this.c.cb(a,b,c)};v.ta=function(a,b,c,d){return this.c.ta(a,b,c,d)};v.ua=function(a,b){return this.c.ua(a,b)};
v.keys=function(a,b,c,d,e,f){return this.c.keys(a,b,c,d,e,f)};v.B=function(a,b,c,d,e,f){return this.c.B(a,b,c,d,e,f)};v.va=function(a,b,c){return this.c.va(a,b,c)};v.clear=function(a,b,c){return this.c.clear(a,b,c)};v.eb=function(a,b,c){return this.c.eb(a,b,c)};v.toString=function(){return"Storage:"+this.getName()+":"+this.t()};function Pf(a,b,c){Nf.call(this,a,b,c)}G(Pf,$);v=Pf.prototype;v.ub=function(a){var b=this.k();if("indexeddb"==b)return new Xe(this.e,this.b,a);if("websql"==b)return new $e(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new bf(this.e,this.b,a);k(new Wc("No executor for "+b))};v.Ia=function(a,b,c){return new cf(this,this.b,c||"",a)};v.Oc=function(a,b,c){return this.c.ic(a,b,c)};v.Pc=function(a,b,c){return this.c.jc(a,b,c)};v.map=function(a,b){return this.c.map(a,b)};
v.reduce=function(a,b,c){return this.c.reduce(a,b,c)};function Qf(a,b,c){Nf.call(this,a,b,c)}G(Qf,Pf);Qf.prototype.ub=function(a){var b=this.k();if("indexeddb"==b)return new lf(this.e,this.b,a);if("websql"==b)return new pf(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new qf(this.e,this.b,a);k(new Wc("No executor for "+b))};Qf.prototype.Ia=function(a,b,c){return new rf(this,this.b,c||"",a)};Qf.prototype.executeSql=function(a,b){return this.c.executeSql(a,b)};function Rf(a,b,c){Nf.call(this,a,b,c)}G(Rf,Qf);function Sf(a,b){Ve.call(this,a,b)}G(Sf,Ve);Sf.prototype.b=ba(s);Sf.prototype.c=function(a,b){function c(b){x(a[b])?(e=s,d[b]=p):(d[b]=s,0<=b-1&&c(b-1))}var d=[],e=p;c(a.length-1);e&&(d=[]);var f;a:{f=d;var g,h=g!=q;if(!x(g)){g=b[0];for(var h=g!=q,j=1;h&&j<b.length;j++)if(b[j]==q||0!=za(b[j],g))h=s}if(h&&(this.f++,this.a&&this.a.push(g),x(this.h)&&this.f>=this.h)){f=[];break a}}return f};function Tf(a,b){Ve.call(this,a,b);this.e=a instanceof Re&&!!a.qa}G(Tf,Ve);Tf.prototype.k=V("ydn.db.algo.ZigzagMerge");Tf.prototype.e=s;Tf.prototype.b=function(a,b){var c=Tf.J.b.call(this,a,b);if(this.e){var d=a[0].Ba().split(", ");1<d.length?d[d.length-1]!=this.a.qa&&k(new Tc("Output streamer projection field must be same as postfix field in the iterator")):P(this.k,"Unable to check correctness of output streamer.")}return c};
Tf.prototype.c=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}var d=[];if(0==a.length||a[0]==q||a[0]==q)return[];for(var e=p,f=0,g=a[f][a[f].length-1],h=[],j=1;j<a.length;j++)if(a[j]!=q){var n=a[j][a[j].length-1],m=za(g,n);h[j]=m;1===m?e=s:-1===m&&(e=s,g=n,f=1)}else return[];if(e){for(e=0;e<a.length;e++)a[e]!=q&&(d[e]=p);this.a&&(this.e?this.a.push(b[0],g):this.a.push(b[0]));return d}if(0==f)for(e=1;e<a.length;e++)1===h[e]&&(d[e]=c(a[e],g));else for(e=0;e<a.length;e++)e!=
f&&a[e]!=q&&1===za(g,a[e][a[e].length-1])&&(d[e]=c(a[e],g));return{"continue":d}};function Uf(a,b){Ve.call(this,a,b)}G(Uf,Ve);Uf.prototype.b=ba(s);Uf.prototype.c=function(a,b){var c=[],d=b[0];if(d==q)return[];for(var e=p,f=s,g=d,h=[],j=1;j<a.length;j++)if(b[j]!=q){var n=za(d,b[j]);h[j]=n;1===n?e=s:-1===n&&(e=s,f=p,1===za(b[j],g)&&(g=b[j]))}else e=s,f=p;if(e)for(f=0;f<a.length;f++)b[f]!=q&&(c[f]=p);else if(f)for(f=0;f<a.length;f++)b[f]!=q&&1===za(g,b[f])&&(c[f]=g);else for(f=1;f<a.length;f++)1===h[f]&&(c[f]=d);return e?(this.f++,this.a&&this.a.push(g),c):{continuePrimary:c}};F("ydn.db.Storage",Rf);F("ydn.db.algo.NestedLoop",Sf);F("ydn.db.algo.ZigzagMerge",Tf);F("ydn.db.algo.SortedMerge",Uf);L.prototype.done=L.prototype.ca;L.prototype.fail=L.prototype.Kb;L.prototype.then=L.prototype.C;L.prototype.always=L.prototype.nc;Ld.prototype.addEventListener=Ld.prototype.addEventListener;F("ydn.db.con.Storage",Z);Z.prototype.getType=Z.prototype.k;Z.prototype.setName=Z.prototype.q;Z.prototype.getName=Z.prototype.getName;Z.prototype.getSchema=Z.prototype.wc;Z.prototype.transaction=Z.prototype.transaction;Z.prototype.close=Z.prototype.Wa;F("ydn.db.version","0.4.7");
F("ydn.db.deleteDatabase",function(a,b){Ee&&((!b||"indexeddb"==b)&&Ee&&"deleteDatabase"in Ee)&&Ee.deleteDatabase(a);if(fa(w.openDatabase)&&(!b||"websql"==b)){var c=new Fe,d=new He;Q(c.o,"deleting websql database: "+a);var d=c.ra(a,d),e=function(){c.o.log(yc,"all tables in "+a+" deleted.",l)};d.ca(function(){c.Qa(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var f=e.rows.length,m=0,r=0;r<f;r++){var u=e.rows.item(r);"__WebKitDatabaseInfoTable__"==
u.name||"sqlite_sequence"==u.name||(m++,S(c.o,"deleting table: "+u.name),b.executeSql("DROP TABLE "+u.name))}Q(c.o,m+' tables deleted from "'+a+'"')}},function(a,b){k(b)})},[],O,e)});d.Kb(function(){P(c.o,"Connecting "+a+" failed.")})}if(!b||"localstorage"==b){var d=new vf,f=new He;d.ra(a,f);Rd(d)}if(!b||"sessionstorage"==b)d=new wf,f=new He,d.ra(a,f),Rd(d)});yf.prototype.name=yf.prototype.name;yf.prototype.getVersion=yf.prototype.Nc;yf.prototype.getOldVersion=yf.prototype.tc;
yf.prototype.getError=yf.prototype.Mc;Nf.prototype.branch=Nf.prototype.Jb;Nf.prototype.run=Nf.prototype.zc;Ie.prototype.abort=Ie.prototype.abort;Nf.prototype.abort=Nf.prototype.abort;F("ydn.db.crud.Storage",$);$.prototype.branch=$.prototype.Jb;$.prototype.add=$.prototype.cb;$.prototype.get=$.prototype.ua;$.prototype.values=$.prototype.B;$.prototype.put=$.prototype.va;$.prototype.clear=$.prototype.clear;$.prototype.remove=$.prototype.eb;$.prototype.count=$.prototype.ta;Je.prototype.add=Je.prototype.cb;Je.prototype.get=Je.prototype.ua;Je.prototype.values=Je.prototype.B;Je.prototype.put=Je.prototype.va;Je.prototype.clear=Je.prototype.clear;Je.prototype.remove=Je.prototype.eb;
Je.prototype.count=Je.prototype.ta;F("ydn.db.cmp",za);F("ydn.db.Key",ed);ed.prototype.id=ed.prototype.sc;ed.prototype.parent=ed.prototype.Ic;ed.prototype.storeName=ed.prototype.Jc;F("ydn.db.KeyRange",I);I.upperBound=function(a,b){return new I(l,a,l,b)};I.lowerBound=function(a,b){return new I(a,l,b,l)};I.bound=ra;I.only=function(a){return new I(a,a,s,s)};I.starts=sa;xf.prototype.store_name=xf.prototype.e;xf.prototype.getStoreName=xf.prototype.h;Ne.prototype.name=Ne.prototype.name;
Ne.prototype.getKey=Ne.prototype.f;Ne.prototype.getValue=Ne.prototype.k;Le.prototype.name=Le.prototype.name;Le.prototype.getKeys=Le.prototype.Ta;Le.prototype.getValues=Le.prototype.f;Pf.prototype.scan=Pf.prototype.Pc;Pf.prototype.map=Pf.prototype.map;Pf.prototype.reduce=Pf.prototype.reduce;Pf.prototype.open=Pf.prototype.Oc;cf.prototype.scan=cf.prototype.jc;cf.prototype.map=cf.prototype.map;cf.prototype.reduce=cf.prototype.reduce;cf.prototype.open=cf.prototype.ic;Ue.prototype.key=Ue.prototype.kc;We.prototype.primaryKey=We.prototype.r;We.prototype.value=We.prototype.fb;We.prototype.update=We.prototype.Hb;We.prototype.clear=We.prototype.clear;Ye.prototype.primaryKey=Ye.prototype.r;
Ye.prototype.value=Ye.prototype.fb;Ye.prototype.update=Ye.prototype.Hb;Ye.prototype.clear=Ye.prototype.clear;F("ydn.math.Expression",df);df.prototype.evaluate=df.prototype.b;df.prototype.compile=df.prototype.c;df.parseRpn=function(a){return new df(a.match(/[^\s"']+|"[^"]*"|'[^']*'/g))};df.parseInfix=function(){k(new id("Too lazy to learn Dutch in Shunting Yard station, we speak Polish here."))};F("ydn.db.Iterator",W);F("ydn.db.KeyCursors",Mc);F("ydn.db.ValueCursors",Oc);F("ydn.db.Cursors",Nc);
F("ydn.db.IndexValueCursors",Pc);W.prototype.count=W.prototype.Bc;W.prototype.done=W.prototype.rc;W.prototype.getKeyRange=W.prototype.Dc;W.prototype.getIndexName=W.prototype.Ba;W.prototype.getStoreName=W.prototype.Ec;W.prototype.isReversed=W.prototype.Gc;W.prototype.isUnique=W.prototype.dc;W.prototype.isKeyOnly=W.prototype.Fc;W.prototype.primaryKey=W.prototype.r;W.prototype.key=W.prototype.Cc;W.prototype.resume=W.prototype.yc;W.prototype.reset=W.prototype.Hc;
Mc.where=function(a,b,c,d,e){return new Mc(a,Ba(b,c,d,e))};Oc.where=function(a,b,c,d,e){return new Oc(a,Ba(b,c,d,e))};Nc.where=function(a,b,c,d,e,f){return new Nc(a,b,Ba(c,d,e,f))};Pc.where=function(a,b,c,d,e,f){return new Pc(a,b,Ba(c,d,e,f))};F("ydn.db.Streamer",Re);Re.prototype.push=Re.prototype.push;Re.prototype.collect=Re.prototype.qc;Re.prototype.setSink=Re.prototype.ac;var Vf=new function(){this.a=pa()};function Wf(a){this.e=a||"";this.f=Vf}Wf.prototype.a=p;Wf.prototype.b=s;function Xf(a){a=new Date(a.h);return Yf(a.getFullYear()-2E3)+Yf(a.getMonth()+1)+Yf(a.getDate())+" "+Yf(a.getHours())+":"+Yf(a.getMinutes())+":"+Yf(a.getSeconds())+"."+Yf(Math.floor(a.getMilliseconds()/10))}function Yf(a){return 10>a?"0"+a:String(a)}function Zf(a,b){var c=(a.h-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function $f(a){Wf.call(this,a)}G($f,Wf);$f.prototype.b=p;
$f.prototype.c=function(a){var b;switch(a.f.value){case vc.value:b="dbg-sh";break;case wc.value:b="dbg-sev";break;case xc.value:b="dbg-w";break;case yc.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.e," ");this.a&&c.push("[",Xf(a),"] ");c.push("[",Ma(Zf(a,this.f.a)),"s] ");c.push("[",Fa(a.c),"] ");c.push('<span class="',b,'">',Ea(Ma(Fa(a.e))));this.b&&a.b&&c.push("<br>",Ea(Ma(a.a||"")));c.push("</span><br>");return c.join("")};function ag(a){Wf.call(this,a)}G(ag,Wf);
ag.prototype.c=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Xf(a),"] ");b.push("[",Zf(a,this.f.a),"s] ");b.push("[",a.c,"] ");b.push(a.e,"\n");this.b&&a.b&&b.push(a.a,"\n");return b.join("")};function bg(){this.f=na(this.h,this);this.a=new ag;this.a.a=s;this.b=this.a.b=s;this.c="";this.e={}}bg.prototype.h=function(a){if(!this.e[a.c]){var b=this.a.c(a),c=cg;if(c)switch(a.f){case vc:dg(c,"info",b);break;case wc:dg(c,"error",b);break;case xc:dg(c,"warn",b);break;default:dg(c,"debug",b)}else window.opera?window.opera.postError(b):this.c+=b}};var cg=window.console;function dg(a,b,c){if(a[b])a[b](c);else a.log(c)};var fg,gg=!$b||$b&&9<=mc;!ac&&!$b||$b&&$b&&9<=mc||ac&&kc("1.9.1");$b&&kc("9");function hg(a,b){var c;c=a.className;c=B(c)&&c.match(/\S+/g)||[];for(var d=gb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=xa(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};var ig={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function jg(a){this.a=a||w.document||document}function kg(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
jg.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!gg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',Fa(g.name),'"');if(g.type){f.push(' type="',Fa(g.type),'"');var h={};Rb(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);if(g)if(B(g))f.className=g;else if(y(g))hg.apply(q,[f].concat(g));else{var j=f;Ob(g,function(a,b){"style"==b?j.style.cssText=a:"class"==b?j.className=a:"for"==b?j.htmlFor=a:b in ig?j.setAttribute(ig[b],a):Ca(b,"aria-")||Ca(b,"data-")?
j.setAttribute(b,a):j[b]=a})}if(2<e.length)for(var n=d,m=f,d=e,e=function(a){a&&m.appendChild(B(a)?n.createTextNode(a):a)},g=2;g<d.length;g++)if(h=d[g],A(h)&&!(E(h)&&0<h.nodeType)){var r=Xa,u;a:{if((u=h)&&"number"==typeof u.length){if(E(u)){u="function"==typeof u.item||"string"==typeof u.item;break a}if(fa(u)){u="function"==typeof u.item;break a}}u=s}r(u?db(h):h,e)}else e(h);return f};
jg.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function lg(a){this.f=na(this.h,this);this.b=new $f;this.c=this.b.a=s;this.a=a;this.e=this.a.ownerDocument||this.a.document;var b=(a=this.a)?new jg(9==a.nodeType?a:a.ownerDocument||a.document):fg||(fg=new jg),c=q;$b?(a=c=b.a.createStyleSheet(),$b?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"):(a=kg(b,"head")[0],a||(c=kg(b,"body")[0],a=b.b("head"),c.parentNode.insertBefore(a,c)),b=c=b.b("style"),$b?b.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
b.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}",a.appendChild(c));this.a.className+=" logdiv"}
lg.prototype.h=function(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.e.createElement("div");c.className="logmsg";c.innerHTML=this.b.c(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)};lg.prototype.clear=function(){this.a.innerHTML=""};var mg=q,ng=q;F("ydn.debug.log",function(a,b,c){if(D(b))b=new uc("log",b);else if(B(b)){b=b.toUpperCase();if(!Ec){Ec={};for(var d=0,e;e=Dc[d];d++)Ec[e.value]=e,Ec[e.name]=e}b=Ec[b]||q}else b=Ac;V(a||"ydn").b=b;x(c)?ng||(a=ng=new lg(c),p!=a.c&&(c=Lc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.c=p),Lc().b=xc):!mg&&!ng&&(a=mg=new bg,p!=a.b&&(c=Lc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.b=p),Lc().b=xc)});Z.prototype.db=Z.prototype.Kc;})();

            //@ sourceMappingURL=zvs-ydn.db-dev.js.map
        

            })(jQuery);
        